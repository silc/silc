Fri Aug 17 23:07:45 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed the getkey command handling in the server.  Send just
	  empty OK reply to the sender if the key could not be fetched
	  (but everything else was ok, like the key just was not available).
	  Changed the public key parameter to optional in the protocol
	  specs so that empty OK reply can be sent.  Affected file
	  silcd/command.c.

	  Added a message to Irssi SILC client to tell to user if the
	  server did not return a public key.

Tue Aug 14 07:29:27 CEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed a channel key regeneration bug.  It registered new
	  timeout tasks exponentially until all system resources were
	  used.  Affected file silcd/server.c.

Sun Aug 12 20:48:14 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added the SILC Document generator to the scripts/silcdoc.
	  It can be used to generate the Toolkit Reference Manual out
	  of the source tree.  Internally it will also use the RoboDoc
	  generator now imported in util/robodoc.

Sun Aug 12 12:28:17 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added couple of return's in rekey protocol if error orccurred
	  during the protocol.  The execution must be terminated.
	  Affected file silcd/protocol.c.  Also, terminate the protocol
	  always with timeout.

Sat Aug 11 12:36:02 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* The client's Client ID was created initally from the wrong
	  nickname (it could have been in format nick@host) in the
	  silc_server_new_client.  Affected file silcd/packet_receive.c

Sat Aug 11 00:29:57 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added some SILC_LOG_ERROR's to various error conditions
	  if client could not be added to ID cache.  Affected files
	  silcd/packet_receive.c and silcd/server.c.

	* When client's sock->user_data is freed, NULL also the 
	  client->router and client->connection pointers.  Added check
	  for these pointers being NULL to various places around the
	  code.  Affected file silcd/server.c.

	* Added client->data.registered == TRUE checks to various
	  places around the code to assure that unregistered client's
	  are not handled when it is not allowed.  Affected file
	  silcd/server.c.

	* Added `bool registered' fields to all 
	  silc_idlist_[server|client]_get_* routines to indicate whether
	  the fetched client needs to be registered or not.  Affected
	  file silcd/idlist.[ch].

	* Add your own entry as registered to the ID cache in the
	  server.  Affected file server.c.

	* Fixed a bug in silc_server_new_server.  The SilcServer was
	  set as the new server's context instead of SilcServerEntry.
	  This naturally caused some weird bugs.

Thu Aug  9 18:28:37 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Do not delete the channel rekey task when adding it
	  for in silc_server_create_channel_key.

	* Changed the silc_server_create_channel_key to return
	  TRUE or FALSE to indicate the success of the channel key
	  creation.

Thu Jul 26 11:32:31 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed MSVC++ project files and added missing files to
	  Makefiles under win32/.

Wed Jul 25 18:43:54 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Do not add TCP_NODELAY flag if the operating system
	  does not have it defined.  Affected files are
	  lib/silcutil/[unix/win32]/silc[unix/win32]net.c.

	* Fixed buffer overflow from Irssi SILC Client.  Affected
	  file irssi/src/fe-common/core/themes.c.

	* Fixed double free in client library in the file
	  lib/silcclient/client.c when disconnecting from server.

	* Applied double free patch from cras to Irssi SILC client.
	  Affected files irssi/src/core/[modules/expandos].c

	* Fixed the disconnection handling to Irssi SILC Client.
	  The application must call silc_client_close_connection
	  in ops->connect client operation in case of failure of
	  the connection.  Affected file is
	  irssi/src/silc/core/client_ops.c.

	* Do not set sock->protocol to NULL in the function
	  silc_client_close_connection after executing the protocol's
	  final callback since the sock might not be valid anymore.
	  Affected file lib/silcclient/client.c.

Wed Jul 25 16:04:35 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Do not enable SILC_THREADS if the linking with libpthread
	  did not happen.  Affected file configure.in.pre.

	* Added notion to protocol specification that server must
	  verify the sent authentication payload with CMODE when
	  setting the channel founder key.  Implemented it to the
	  server.  Affected file silcd/command.c.

Mon Jul 23 18:31:43 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added _EXTRA_DIST SILC distribution variable to the
	  distributions file.  It is used to conditionally add extra
	  files or directories to the specific distribution.  Affected
	  files ./prepare, Makefile.am.pre and distributions.

	  Removed the `_' from the start of the distribution names.
	  It is redundant.

	* Added README.WIN32 for instructions to compile the Toolkit
	  under WIN32.

Mon Jul 23 10:12:37 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed a double free in disconnection in the server.  Affected
	  file is silcd/server.c.

	* Fixed the lib/silcske/groups.c to work now also with GMP
	  MP library.  The string conversion did not work when using
	  specific base and the base is indicated in the string as well.

	* Created win32/ directory which now includes MSVC++ specific
	  stuff so that toolkit (DLLs) may be compiled with MSVC++.
	  It will appear only in the toolkit distribution

Sun Jul 22 19:40:30 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Changed the key material distribution function in case when
	  the hash output is too short.  The data is now concatenated
	  a bit differently than it used to.  Made the change to the
	  SKE protocol specification.

	* Added better GMP detection to configure.in.pre.  A patch
	  by salo.

Fri Jul 20 13:16:00 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed a minor bug in SKE that might cause some problem on
	  some platforms.  Affected file lib/silcske/silcske.c.

	* Added the cookie checking for initiator in the SKE.  It checks
	  that the responder returns the sent cookie unmodified.  The
	  affected file is lib/silcske/silcske.c.  Added new SKE
	  error type INVALID_COOKIE that can be sent during the
	  negotiation.  Fixed some memory leaks as well.

	* Added the "invalid cookie" error message to Irssi SILC client's
	  message formats.

Thu Jul 19 21:44:31 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added `task_max' field to the SilcClientParams to indicate
	  the maximum tasks the scheduler can handle.  If set to zero,
	  default values are used.  Affected file lib/silcclient/silcapi.h.

	* Fixed memory leaks in silc_client_close_connection.  Affected
	  file lib/silcclient/client.c.

	* Added silc_client_del_client_entry to client library to free
	  all memory of given client entry.  Affected file is
	  lib/silcclient/idlist.[ch].

	* Added new functions silc_client_del_channel and
	  silc_client_del_server to delete channel and server entries.
	  Affected file lib/silcclient/[silcapi.h/idlist.c].

	* Removed silc_client_del_client_by_id from silcapi.h.

	* Fixed the INFO command to return the server's own info
	  correctly when querying by Server ID.  Affected file is
	  silcd/command.c.

Thu Jul 19 14:47:30 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Removed the non-blocking settings in WIN32 code in the
	  silc_sock_[read/write] and added SleepEx instead.  Affected
	  file lib/silcutil/win32/silcwin32sockconn.c.  The availability
	  of input data is now checked with FIONREAD and ioctlsocket.

Wed Jul 18 18:34:01 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Call silc_schedule_task_del_by_context in the 
	  silc_protocol_cancel instead of silc_schedule_task_del_by_callback.
	  Affected file lib/silccore/silcprotocol.c.

	* Call silc_protocol_cancel for active protocols in the
	  silc_server_close_connection if the funtion
	  silc_server_free_sock_user_data has not been called.
	  Affected file silcd/server.c.

	* Generic tasks cannot be deleted using the del_by_fd
	  task deleting function since generic tasks does not match
	  any specific fd.  Affected file lib/silcutil/silcschedule.[ch].

	* Added a notion to SILCOPER help file that the SILCOPER works
	  only on router server, not on normal server.

Wed Jul 18 09:40:04 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added for WIN32 support for the new scheduler as well.
	  Affected file lib/silcutil/win32/silcwin32schedule.c.

	* Fixed the SHA1 implementation to work on various platforms.

Tue Jul 17 23:04:10 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Rewrote the SILC Scheduler entirely.  Removed the old SILC Task
	  API.  It is part of the scheduler now.  Everything else is
	  as previously but some functions has changed their names.
	  Checkout the lib/silcutil/silcschedule.h for the interface.
	  Updated all applications to use the new interface.  Affected
	  files are lib/silcutil/silcschedule.[ch].

Tue Jul 17 16:53:30 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Found a bug in the SKE implementation.  The HASH value,
	  specified by the protocol, was not computed correctly.  The
	  public key of the responder was not added to the computation
	  even though it is mandatory.  Affected file lib/silcske/silcske.c.
	  This unfortunately causes incompatibilities with older
	  clients and servers.

	* Added WIN32 specific network init and uninit functions:
	  silc_net_win32_init and silc_net_win32_uninit to init and uninit
	  the Winsock2.  Affected file lib/silcutil/silcnet.h and
	  lib/silcutil/win32/silcwin32net.c.

	* Set the socket always to nonblocking mode on WIN32 after
	  reading data or writing data.  Affected file is
	  lib/silcutil/win32/silcwin32sockconn.c.

Mon Jul 16 22:55:26 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed various compilation problems under WIN32.  Affected
	  files lib/silcutil/win32/silcwin32thread.c and
	  lib/silcutil/win32/silcwin32schedule.c.

	* Removed all _internal.h #includes from public header
	  files.  Internal headers must never be included from
	  public headers.

	  Removed also the lib/silcske/payload_internal.h file.

	* All include files that may be needed (public and some others
	  included by the public headers) by application developers are
	  now copied to the ./includes directory.  It does not copy any
	  internal headers.  Affected file Makefile.defines.pre and all
	  Makefile.am's under lib/ and subdirs.

Thu Jul 12 17:49:31 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Do not change the ~/.silc directory's permissions automatically.
	  Affected file irssi/src/silc/core/clientutil.c.

Thu Jul 12 10:18:40 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Do not cancel the protocol in silc_server_close_connection
	  it might cause recursion.  Now cancelled in the function
	  silc_server_free_sock_user_data.  Affected file silcd/server.c.

	* Fixed the silc_server_remove_clients_by_server to regenerate
	  the channel keys correctly finally.  Added also new function
	  silc_server_remove_clients_channels to actually do it.
	  Affected file silcd/server.c.

	* Fixed the silc_server_new_channel to not crash by giving
	  wrong router to the new channel.  Affected file is
	  silcd/packet_receive.c.

Wed Jul 11 18:31:57 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added SilcClientParams structure to the lib/silcclient/silcapi.h
	  which is given as argument to the silc_client_alloc now.
	  It can be used to configure the client and set various parameters
	  that affect the function of the client.

	* The USERS command in server did not check whether the channel
	  is private or secret.  Affected file silcd/command.c.

	* Added new argument to the USERS command in protocol specification.
	  The USERS command now can take the channel name as argument
	  as well.  Added support for this in client and server and
	  updated the protocol specs.

	* Completed the GETKEY command in client. It can be now used
	  to fetch also servers public key not only some clients. 
	  Affected files lib/silcclient/command[_reply].c.

	* Added silc_client_get_server to return server entry by the
	  server name.  Affected files lib/silcclient/silcapi.h and
	  idlist.c.

	* Redefined the IDENTIFY command in protocol specification to be
	  more generic.  It now can be used to query information about
	  any entity in the SILC Network, including clients, servers and
	  channels.  The query may be based either the entity's name
	  or the ID.  Added support for this in both client and server.

	  Affected files silcd/command.c and lib/silcclient/command.c
	  and command_reply.c.

	* Optimized the WHOIS and WHOWAS commands in the server. Removed
	  the _from_client and _from_server functions.  Affected file
	  silcd/command.c.

	* Added silc_client_get_channel_by_id_resolve to the file
	  lib/silcclient/silcapi.h to resolve channel information by
	  its ID.  Added also silc_client_get_channel_by_id that
	  does not resolve it from the server.

Tue Jul 10 18:05:38 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added SilcServerEntry context into the client library
	  to represent one server.  The INFO command now allocates
	  these to save the resolved server info.  For now on the
	  client library will also keep information about servers,
	  connected and resolved with INFO.

	  The INFO command now allocates the SilcServerEntry context
	  and saves the server info there.  The COMMAND_REPLY in
	  the INFO now returns the parameters to application in 
	  same order as defined in the protocol specification.

	  The entries are cached in the client->server_cache.

	* The INFO command is now issued after received the Client ID
	  from the server.  Affected file lib/silcclient/client.c.

	* The CMODE_CHANGE notify may now return also an SilcServerEntry
	  to the application as the mode changer might be server.
	  It is guaranteed that NULL is not returned anymore to the
	  application.  Affected file lib/silcclient/client_notify.c.

	  The ID Type is now also passed to the application so that
	  it can check whether the returned entry is SilcClientEntry
	  or SilcServerEntry.

	  Added new function silc_client_get_server_by_id to return
	  the server entry by ID.  Affected files are the
	  lib/silcclient/silcapi.h and lib/silcclient/idlist.c.

	* Do not create the channel in the Irssi SILC Client when issuing
	  the JOIN command but when received the sucessful JOIN command
	  reply.  Otherwise the channel might get created even though we
	  could not join it.  The Affected file is
	  irssi/src/silc/core/[silc-channels.c/client_ops.c].

	* Fixed a channel joining bug in router.  The router must also
	  check the channel modes, invite and ban lists etc. when serving
	  the JOIN command sent by normal server.  Affected file is
	  silcd/command.c.  The router now resolves the client's 
	  information from the server who sent the JOIN command if it
	  does not know it, and processes the JOIN command only after
	  that.

	* Changed the SilcCommandCb to take new argument; void *context2.
	  Affected file lib/silccore/silccommand.h

	  The second argument in the command callbacks in the server now
	  includes the SilcServerCommandReplyContext if the command was
	  called as pending command callback from the command reply.
	  Otherwise it is NULL. When called as pending the status of the
	  command reply will be checked and if it was erronous the
	  error will be sent to the original sender of the command.
	  This way the client always receives the error messages even
	  though the server was actually the one who received the error
	  when it resent the command to router, for example.  Affected
	  files silcd/command[_reply].[ch].

	* Fixed sending WHOWAS command's error message to client if
	  the requested client could not be found.  It was missing.
	  silcd/command.c.

	* Changed the CMODE and CUMODE commands reply arguments in the
	  protocol specification.  The Channel ID is now sent in both
	  of the commands to identify the channel.  Implemented this
	  new feature to the client and server.  Affected files
	  lib/silcclient/command_reply.c and silcd/command.c.

	* Made better checks for invite and ban lists in the JOIN
	  command in server.  Affected file silcd/command.c.

Mon Jul  9 18:28:34 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* The server now performs the incoming host IP/DNS lookup
	  using the silc_socket_host_lookup and thus does not block
	  the server anymore.  Affected file silcd/server.c.

	* Completed the multi-thread support for SILC Scheduler in
	  the lib/silcutil/silcschedule.c.

	* Fixed the configure.in.pre to detect the pthread correctly
	  on various systems.

	* Fixed a deadlock in silc_task_queue_wakeup in the file
	  lib/silcutil/silctask.c.

Mon Jul  9 13:40:03 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added new function silc_schedule_wakeup that is used in
	  multi-threaded environment to wakeup the main thread's
	  schduler. It needs to be used when a thread adds a new task
	  or removes a task from task queues. After waking up, the
	  scheduler will detect the task queue changes. If threads
	  support is not compiled in this function has no effect.
	  Implemented the wakeup mechanism to both Unix and WIN32
	  systems.  Affected files are lib/silcutil/silcschedule.[ch],
	  lib/silcutil/unix/silcunixschedule.c and the
	  lib/silcutil/win32/silcwin32schedule.c.

	* Added new function silc_task_queue_wakeup to wakeup the
	  scheduler by the specified task queue.  Affected file
	  lib/silcutil/silctask.[ch].

	* The silc_socket_host_lookup_start now wakes up the scheduler
	  after adding the timeout task.  Affected file is
	  lib/silcutil/silcsockconn.c.

	* The silc_socket_host_lookup is synchronous now if the threads
	  support is not compiled in.  However, the callback is still
	  called asyncronously through the scheduler, anyway.  Affected
	  file lib/silcutil/silcsockconn.c.

Mon Jul  9 00:24:45 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added new function silc_socket_host_lookup to perform
	  asynchronous IP and FQDN lookups for the socket connection.
	  Affected files lib/silcutil/silcsockconn.[ch].

Sun Jul  8 18:44:53 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added SILC_MUTEX_DEFINE to define the mutex on environments
	  that may or may not compile the mutex support in.
	
	  Changed the silc_mutex_alloc interface. It allocates the
	  mutex now to the sent pointer and returns TRUE or FALSE.

	  Affected file lib/silcutil/silcmutex.h.

	* Wrote the SILC Task Queue interface to support multi-threads.
	  Affected file lib/silcutil/silctask.[ch].

	* Wrote the SILC Scheduler to support multi-threads.  Affected
	  file lib/silcutil/silcschedule.c.

Sun Jul  8 11:16:01 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Implemented the SILC Mutex API and SILC Thread API for WIN32
	  in lib/silcutil/win32/.

Sun Jul  8 00:18:15 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Defined SILC Mutex API and SILC Thread API and implemented
	  them for Unix.  Affected files are
	  lib/silcutil/silcmutex.h, lib/silcutil/silcthread.h,
	  lib/silcutil/unix/silcunixmutex.c and
	  lib/silcutil/unix/silcunixthread.c.

Sat Jul  7 14:40:31 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed the silc_server_remove_clients_by_server's channel
	  key re-generation.  The hash table handling was incorrect
	  and would not work with many channels.  Affected file is
	  silcd/server.c.

	* Fixed some memory leaks around the server code.

	* Rewrote the silc_server_get_users_on_channel to support IPv6
	  based Client ID's.  Affected file silcd/server.c.

	* Defined the SILC_MESSAGE_FLAG_SIGNED to the protocol
	  specification.  However, a separate document must be written
	  to define the detailed signing procedure and the payload
	  associated with the flag.  Defined the flag to the
	  lib/silccore/silcchannel.h as well.

Fri Jul  6 18:26:31 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Changed the dynamic tables to static size tables in the
	  lib/silccrypt/silchmac.c.

	* Removed GCC dependencies from the code.  A patch by cras.

Fri Jul  6 09:39:35 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Do not show the error "Error receiving packet bla bla"
	  in server if it really was not an error (-2 means that reading
	  is pending).  Affected file silcd/server.c.

Thu Jul  5 21:22:32 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed a possible crash in silc_server_remove_clients_by_server
	  in silcd/server.c.  Fixed there also some memory leaks.

	* Fixed the silc_idlist_replace_client_id.  It could replace
	  wrong key in the hash table.  Affected file silcd/idlist.c.

	* Do not check whether there are global users on the channel
	  if the channel->global_users is FALSE.  Affected functions
	  silc_server_remove_from_one_channel and
	  silc_server_remove_from_channels in silcd/server.c.  Also,
	  do not check if the removed client is local as we can be
	  sure that global client was not removed from the channel
	  and checking for global users is not needed.

	* The silc_server_remove_clients_by_server now re-generates
	  the channel keys correctly for those channels that had
	  clients removed from them.  Affected file silcd/server.c.

Tue Jul  3 11:39:20 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Found the reason of random crashes in the server.  We weren't
	  ignoring the SIGPIPE signal (which can be sent in write())
	  and it crashed the server.  Affected file silcd/silcd.c.

Fri Jun 29 20:05:25 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Assure that sock->user_data is not NULL in the function
	  silc_server_packet_send in silcd/packet_send.c.

	* Disconnect the remote connection if it could not be added
	  to any ID lists in the server.  The affected file is
	  silcd/server.c.

	* Check in silc_server_packet_send[_real/dest] that the
	  socket is not disconnecting and ignore the data if it is.
	  Affected file silcd/packet_send.c.

	* Define inline to __inline on native WIN32 compilation.
	  Affected file includes/silcwin32.h.

	* Added some explicit type casts for inline code since MSVC
	  require them.  Affected files lib/silcutil/silcbuffer.h,
	  lib/trq/silcdlist.h and lib/trq/silclist.h.

	* Print warning in log files from now on if the packet
	  decryption fails.  Affected file silcd/server.c.

Thu Jun 28 21:30:39 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Changed the `say' client operation's interface to accept
	  new `type' argument to indicate the type of the message sent
	  by the library.  The application may filter the library's
	  messages according the type.  The affected file is the
	  lib/silcclient/silcapi.h.

	* Added two new functions to lib/silcclient/silcapi.h:
	  silc_client_del_client and silc_client_del_client_by_id.
	  Affected file lib/silcclient/idlist.c.

	* Moved the clientincludes.h from includes/ to silc/ and
	  serverincludes.h from includes/ to silcd/.

	* The modes for the CMODE and CUMODE are now passed as
	  uint32 for application with COMMAND_REPLY.  The affected
	  file is lib/silcclient/command_reply.c.

Wed Jun 27 22:24:47 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* /WHOIS without arguments shows client's own information.
	  Affected file lib/silcclient/command.c.

	* Changed PING to not accept any arguments.  The specs
	  says that client can ping only the connected server so
	  requiring an argument is not needed.  Affected file is
	  lib/silcclient/command.c.

Wed Jun 27 00:10:33 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Fixed a fatal bug in private message sending and reception
	  encryption and decryption when using private message keys.
	  The implementation was incorrect and did not follow the
	  specification.  It causd that some of the message were
	  lost since it did not use the sending and receiving keys
	  as the protocol suggests.  This has been fixed and will cause
	  incompatibilities with older clients when sending private
	  message encrypted with private message keys.  Affected files
	  lib/silcclient/client_prvmsg.c, lib/silcclient/client_keyagr.c
	  and various other in Irssi SILC Client.

	  Added `responder' boolean argument to the functions
	  silc_client_add_private_message_key[_ske] to indicate when
	  the key is added as responder or initiator of the key
	  negotiation.

Tue Jun 26 19:23:07 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Removed the silc_ske_check_version function and created
	  a SilcSKECheckVersion callback.  Added also a function
	  silc_ske_set_callbacks that is now used to set all SKE
	  callbacks.  The callback functions are not given to
	  the SKE functions anymore, but this function is used to
	  set the callbacks.

	* Fixed the WIN32 DLL generation in lib/Makefile.am.pre.

	* Added `silc_version' argument to the silc_client_alloc
	  to define the version of the application for the library.
	  The library will use the version string to compare it
	  against the remote host's (usually a server) version
	  string.  Affected file lib/silcclient/silcapi.h

	* Added the KE protocol context to Key Agreement context
	  in client library so that we can abort the SKE if it
	  is in process when we get timeout.  Affected file is
	  lib/silcclient/client_keyagr.c.

	* Do not resolve the client ID forever if it returns in the
	  first time that such client does not exist.  This was done
	  for example with private message.  Affected file is
	  lib/silcclient/client_prvmsg.c.

Mon Jun 25 21:42:51 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Do not add regex.h for WIN32.  The affected file
	  includes/silcincludes.h.

	* Added WIN32 DLL generation to lib/Makefile.am.pre.  It might
	  not work yet 100%.  It generates the DLL's automatically
	  when compiling with --with-win32 under cygwin.

Sun Jun 24 19:49:23 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* lib/contrib/regex.c is not compiled on WIN32.

	* Added silc_net_get_socket_opt function to the
	  lib/silcutil/silcnet.h.

	* Added includes/silcwin32.h for WIN32 specific includes
	  and definitions.

	* Do not use ptime structure or any of the posix process
	  functions on WIN32 in lib/silccrypt/silrng.c.

	* Added silc_gettimeofday to provide generic function
	  for struct timeval on all platforms.  Added the function
	  to lib/silcutil/silcutil.h.

Sun Jun 24 12:19:52 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Moved the lib/silccore/silcsockconn.[ch] to the utility
	  library as they clearly belong there.  As a plus side we
	  can make the actual socket connection routines platform
	  specific.

	  Added also new generic function silc_socket_read and
	  silc_socket_write (that used to be silc_packet_[read/write].
	  The implementation of these are platform specific.

	* Added WIN32 specific routines of silc_socket_[read/write]
	  to lib/silcutil/win32/silcwin32sockconn.c.

Sat Jun 23 16:01:00 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Added preliminary support for native WIN32 compilation under
	  cygwin (using the -mno-cygwin option for GCC) to the
	  ./configure.in.pre.  The --with-win32 now prepares the
	  compilation for native WIN32.

	* Rewrote the SILC Scheduler interface in the file
	  lib/silcutil/silcschedule.h.  The scheduler is now context
	  based and does not have anymore any global static scheduler.
	  Moved the Unix scheduler to the lib/silcutil/unix/ directory
	  and created lib/silcutil/win32 directory for WIN32 based
	  scheduler.

	* Added Unix specific network routines to the
	  lib/silcutil/unix/silcunixnet.c and the old
	  lib/silcutil/silcnet.c includes now only generic routines.

	  Added WIN32 specific network routines to the
	  lib/silcutil/win32/silcwin32net.c.

	* Added Unix specific utility functions from the
	  lib/silcutil/silcutil.c to lib/silcutil/unix/silcunixutil.c.

	* Added WIN32 SILC Scheduler to the file
	  lib/silcutil/win32/silcwin32schedule.c. The code is of course
          untested.

Fri Jun 22 10:44:14 EEST 2001  Pekka Riikonen <priikone@silcnet.org>

	* Do not handle JOIN notify in the server if the target client
	  is not registered (idata->registered == FALSE).  The affected
	  file is silcd/packet_receive.c.

	* Update the nickrec->founder in event_cumode in the Irssi SILC
	  client.  Affected file irssi/src/silc/core/silc-channels.c.

	* Fixed the CUMODE_CHANGE notify handling in the server when
	  server and router are announcing their clients on channels.
	  Now the mode changes are saved and notified correctly.  The
	  affected file is /silcd/packet_receive.c.

	* Fixed silc_idlit_replace_[server/client/channel]_id functions.
	  They really did not replace the cache entry in the ID Cache.
	  Now they do that.  Affected file silcd/idlist.c.

	* Fixed the KICK notify handling in the Irssi SILC client to
	  update the channel records so that the kicked client does not
	  appear to be on the channel.  The affected file is 
	  irssi/src/silc/core/silc-channels.c.

	* Always update the conn->current_channel when executing command
	  on a channel.  Affected file irssi/src/silc/core/silc-servers.c.

	* Fixed the KILL notify handling in Irssi SILC client to remove
	  the killed client on all channels.

Thu Jun 21 17:10:08 CEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the silc_parse_command_line to remove extra spaces
	  from the start and end of the arguments.  Affected file is
	  lib/silcutil/silcutil.c.

	* Cancel and free any active protocol in the function
	  silc_server_close_connection.  Affected file silcd/server.c.

	* Cancel and free any active protocol in the function
	  silc_client_close_connction.  Affected file is
	  lib/silcclient/client.c.

	* Do not execute the KILL command for clients that are in
	  history (ie. they are not in the network).  Affected file is
	  silcd/command.c.

	* Fixed KILL notify handling, client does not crash anymore.
	  Affected file irssi/src/silc/core/silc-channels.c.

	* Reduced the default packet buffer size from 2048 to 1024 in	
	  lib/silccore/silcpacket.c.

	* Added SILC_SKE_STATUS_FREED SKE status type and a reference
	  counter to the SKE context that is incresed when the SKE library
	  performs async operation outside the library.  If the outside
	  process frees the SKE context and FREED status will be set 
	  and the library will detect after the sync operation that the
	  libary is freed.  The affected files are
	  lib/silcske/silcske[_status].[ch].

	* Resolve the client entry information in the function
	  silc_client_channel_message to assure that NULL pointer is not
	  passed as client entry to the application. */

	* Fixed the task timeout calculation to assure that there is
	  never negative timeouts.  The affected file is 
	  lib/silcutil/silcschedule.c.

	* Fixed the channel user mode notification sending in server.
	  It was sent point-to-point to the router (or to server by router)
	  but it needs to be destined to a channel.  The routines now
	  supports sending the channel user mode notifys to the channels
	  when announcing clients and channels.  Affected files are
	  silcd/server.c and silcd/packet_receive.c.

	* Fixed the CHANNEL_CHANGE notify handling in the client libary.
	  It did not actually replace the old channel entry in the cache.
	  Affected file lib/silcclient/client_notify.c.

Tue Jun 19 22:10:36 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a possible crash in silc_packet_send_prepare.  It now
	  assures always that there is enough space in the buffer and
	  at the tail area of the buffer (for MAC). 

	  Fixed the inbound buffer reallocation in silc_packet_read.
	  It was old code and did not handle the reallocation correctly.
	  Affected

	  The affected file is lib/silccore/silcpacket.c.

	* Fixed buffer overflow in silc_parse_nickname in the file
	  lib/silcutil/silcutil.c.

Tue Jun 19 13:40:09 CEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* make install generates new server keys only if there is not
	  keys already.

Mon Jun 18 18:49:07 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Set SILC_MESSAGE_FLAG_NOREPLY when sending the away message.
	  Added check that if the NOREPLY is set then we will not send
	  the away message.  This avoids infinite loop of away messages
	  if both clients are away.  The affected file is
	  lib/silcclient/client_prvmsg.c.

	* Fixed client crash if /NICK was given without arguments.
	  Affected file lib/silcclient/command.c.

	* Server does not send the invite list in INVITE command back
	  to the client if the list was not altered.  Added this notion
	  to the protocol spec as well.  Affected file silcd/command.c.

	  Fixed possible crash in INVITE command by checking the
	  value of silc_server_get_client_route command.

	* Fixed the INVITE notify type handling.  The arguments are now
	  taken in correct order and client does not crash.  The affected
	  file is irssi/src/silc/core/silc-channels.c.

	  Removed the "Inviting xxx to channel" message from the
	  client library away and let the application handle it.
	  Affected file lib/silcclient/command.c.  Added that message
	  to Irssi SILC client's message formats.

	* Fixed CMODE command crash in client.  It now checks the
	  amount of arguments correctly and does not crash.  The affected
	  file is lib/silcclient/command.c.

	* Do not create new channel automatically in silc_channels_join
	  but check whether the channel by that name already exists.
	  Affected file irssi/silc/core/silc-channels.c.

	* Do not send the SERVER_SIGNOFF to router if the disconnected
	  entity was the router.  Affected file silcd/server.c.

	* Added the handling of the SERVER_SIGNOFF notify to the Irssi
	  SILC client as it was missing from there.

	  Added the handling of the KICK notify to the Irssi SILC client
	  as it was missing.  Added "you have been kicked" message to
	  Irssi SILC client's message modules formats.

	  Added the handing of the KILL notify to the Irssi SILC client
	  as it was missing.  Added the kill message module formats 
	  as well.

  	  The affected file is irssi/src/silc/core/silc-channels.c.

	* The router did not save the channel mode the server announced.
	  Affected file silcd/packet_receive.c.

	* Fixed a possible crash in INFO command in server.  If the
	  server did not provide the server info it crashed.  Affected
	  file silcd/command.c.

Sun Jun 17 15:26:05 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the GETKEY command in the server to check also the
	  global list.  Otherwise the GETKEY would not work correctly
	  in normal SILC server.  Affected file silcd/command.c.

Sat Jun 16 18:00:00 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed GETKEY crash, it crashed if the command did not succseed.

Tue Jun 12 21:36:18 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Redefined the SILC MP API in lib/silcmath/silcmp.h. The API
	  is now real and not just an macro interface to GMP.

	  Removed the entire GMP from the source tree and imported new
	  NSS MPI library instead.  Reason for removing GMP is that it is
	  extremely large and compiles extremely slow.  The NSS MPI
	  is only a few files and compiles in less than 10 seconds.
	  The speed is also about the same as GMP.  The MPI is imported
	  to lib/silcmath/mpi.

	  If the system has GMP installed we will still use the GMP.
	  If it is not then the NSS MPI will be compiled.

Mon Jun 11 18:07:24 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Merged a long nickname (127 characters long) crash bugfix from
	  Irssi CVS tree.  Affected file irssi/src/core/misc.c.

	* Merged a freed memory reference bugfix from Irssi CVS tree.
	  Affected file irssi/src/core/commands.c.

Sun Jun 10 16:08:35 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added the server's public key sving and verification to the
	  server when performing the SKE.  This was missing and the
	  remote server's (or router's) public key was accepted without
	  checking whether we have it previously or trust it at all.
	  Affected file silcd/protocol.c.

Sat Jun  9 20:17:30 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Check in the silc_server_timeout_remote if protocol is active
	  and make sure that the protocol's final callback is called so
	  that all memory if freed.  Affected file silcd/server.c.

Sat Jun  9 12:51:27 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* silc_server_whois_send_reply crashed the server if the nickname
	  was 127 characters long.  Affected file silcd/command.c.

Thu Jun  7 16:29:56 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added sanity check to the silc_server_new_client. If the hostname
	  is provided inside username then check that the provided hostname
	  really is the same as the resolved one.  If the hostname was not
	  resolved then check it from the public key.  Affected file is
	  silcd/packet_receive.c.

	* Fixed a fatal bug in Irssi SILC client. Do not send QUIT command
	  if the server disconnected us and the connection is not valid
	  anymore.  Affected file irssi/src/silc/core/silc-channels.c.

 	* Moved the silc_client_[chmode|chumode|chumode_char] away from
	  the library to the lib/silcutil/silcutil.[ch].

Thu Jun  7 08:57:16 CEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Close log file after open.  Affected file 
	  lib/silcutil/silclog.c.

	* Check whether sock == NULL in silc_client_send_packet and return
	  if it is.  Affected file lib/silcclient/silcclient.c.

	* Check rec->entry == NULL in the Irssi SILC Client before
	  sending the channel message.  Affecte file is
	  irssi/src/silc/core/silc-servers.c.

Tue Jun  5 08:08:21 CEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Merged a splitted window bugfix from Irssi CVS tree.  The 
	  affected file is irssi/src/fe-text/textbuffer-view.c.

	* Fixed the ME, ACTION and NOTICE printing in Irssi Client.
	  It did not print nickname.

	* Improved the distributions system a bit.

Mon Jun  4 17:57:16 CEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Merged /WINDOW bugfix from irssi CVS tree. Affected file is
	  irssi/src/fe-text/gui-window.c.

	* Fixed a fatal bug in Irssi SILC client. Crashed if sent message
	  to in-active server.  The affected file is
	  irssi/src/silc/core/client_ops.c.

	* Resolve the client in USERS command reply if the entry does
	  not have username resolved.  The affected file is
	  lib/silcclient/command_reply.c.  Also, changed the IDENTIFY
	  command to WHOIS command to really resolve stuff.  The USERS
	  is not used any more in any critical section so WHOIS can
	  be used even though it might be slower than IDENTIFY.

	* Changed the lib/silcutil/silchashtable.h header to ROBODoc
	  format.

Sun Jun  3 14:21:32 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed the protocol API a bit more consistent in the
	  lib/silccore/silcprotocol.[ch].

	* Changed the following headers to ROBODoc format:

		lib/silccore/silcpayload.h
		lib/silccore/silcprotocol.h
		lib/silccore/silcsockconn.h

	  All core library headers are now formatted.

Sat Jun  2 10:45:09 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a bug in Irssi SILC client; do not show that you are
	  server/router operator if you really are not.  Affected file is
	  irssi/src/silc/core/client_ops.c.

	* Renamed silc_command_free_payload to silc_command_payload_free.
	  Affected file lib/silccore/silccommand.h

	* Added silcmath.h to include the prototoypes of various routines
	  in the lib/silcmath.  Removed the old modinv.h, mpbin.h and
	  silcprimegen.h.

	* Changed the following headers to ROBODoc format:

		lib/silccore/silcchannel.h
		lib/silccore/silccommand.h
		lib/silccore/silcid.h
		lib/silccore/silcidcache.h
		lib/silccore/silcmode.h
		lib/silccore/silcnotify.h
		lib/silccore/silcpacket.h
		lib/silcmath/silcmath.h

Fri Jun  1 22:19:37 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added checking to the server code not to start the server if
	  ciphers and stuff are not configured properly.  Affected files
	  silcd/serverconfig.[h] and silcd/server.c.

	* Changed the layout of the header files of the public interfaces
	  in the SILC libraries.  The new layout supports ROBODoc 
	  documentation tool (and some others) so that it is easy to create
	  a library reference manual.  All the other headers and source
	  code must still follow the CodingStyle document.  Also source
	  code must not include these ROBODoc stuffs, only the headers.
	  Furthermore, all public interface headers must now be named
	  by using `silc' prefix, example: silcapi.h, silccipher.h.
	  Some files were renamed due to this.  All the other headers
	  must not be used as public interfaces.  I will update the
	  CodingStyle document later.  Changed following headers, so far:

		lib/silcclient/silcapi.h
		lib/silccore/silcauth.h
		lib/silccore/silcprivate.h
		lib/silccrypt/silcdh.h

Fri Jun  1 10:28:09 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Updated TODO.

	* Removed silc_client_packet_send_flush from the client library
	  as it is not needed.  Affected file lib/silcclient/client.[ch].

	* Added printing of message of unresolved authentication method
	  to the Irssi SILC client.  Added it to the module formats.
	  Removed the same message from the client library.

Thu May 31 13:57:33 CEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new distribution feature, DISTLABEL.  Every distribution
	  can define own preprocessor label that can be used in the
	  source code.  For example: #ifdef SILC_DIST_CLIENT.  Affected
	  file distributions, acconfig.h.pre and prepare.

Tue May 29 22:16:40 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added Makefile.defines_int to include the actual definitions
	  for Makefile.defines.in.  Tested the new distribution system,
	  created distributions and tested installation.

	* Added AWAY message printing to the Irssi SILC client.  Added
	  the messages to the irssi/src/fe-common/silc/module-formats.[ch].

	* Added SCONNECT command to call the SILC's CONNECT command.
	  Cannot use CONNECT directly since Irssi uses that internally.
	  Affected file irssi/src/silc/core/silc-servers.c.

	  Added ACTION local command.  It is same as ME command but takes
	  the channel as mandatory argument.

	  Rewrote some of the Irssi's help files to suite for SILC
	  protocol.

Mon May 28 19:05:22 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added Makefile.defines[.in] that should for now on be included
	  in all Makefile.am file in the source tree.  That file includes
	  all common compilation definitions for SILC source tree.

Mon May 28 10:30:51 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Minor changes to the ./prepare script to change the package
	  name according the distribution name to the configure.in.

Sun May 27 22:24:57 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Created new distribution system.  Added file `distributions'
	  that defines all the distributions that can be created out of
	  the SILC source tree.  The ./prepare script now reads that
	  file to determine how to prepare the distributions.  The
	  first argument to the ./prepare is the name of the distribution
	  and second is the version of the distribution.  If given
	  without arguments it creates the default (toolkit) distribution
	  with the default version (defined in ./prepare).

	  All Makefile.am files that are subject to the distributions
	  are now named as Makefile.am.pre.  These are ./Makefile.am
	  and lib/Makefile.am.  Others may be changed later.

Sun May 27 15:57:17 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added invite list, ban list, some key management and connection
	  error message printing to module formats in the Irssi SILC client.

	* Added new silc_client_set_away_message to set the away message
	  that is back to the person who sent private message.  The 
	  affected file lib/silcclient/silcapi.h and the
	  lib/silcclient/client_prvmsg.c.

Sun May 27 12:39:48 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the private message sending in the Irssi SILC client,
	  added local command KEY to the Irssi SILC client.

	  Added key management and key agreement message formats to the
	  irssi/src/fe-common/silc/module-formats.[ch].

	  Added USERS (alias WHO) printing, server/router operator
	  indication and LIST command printing to the module formats.

Sat May 26 17:43:42 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed channel joining notify handling, cumode notify handling
	  from Irssi SILC client.

	* Added SILC specific module-formats to the Irssi SILC client so
	  that SILC specific message hilighting, colors etc is possible.
	  Affected file irssi/src/fe-common/silc/module-formats.[ch].

	  Added channel mode, channel user mode, actions, notices,
	  whois and whowas printing to the the module-formats.c.

	* Fixed a bug in channel deletion in the server.  The channel
	  is not left to the cache even if the channel founder auth mode
	  is set when there are no users anymore on the channel.  Affected
	  file silcd/server.c.

	* The silc_net_localhost now resolves the entire hostname including
	  the domain name.  Affected file lib/silcutil/silcnet.c.

Sat May 26 12:13:37 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed the ask_passphrase client operation to be ascynchronous.
	  It has now a completion callback and a context that the 
	  application must call after it has got the passphrase from
	  the user.  Affected files lib/silcclient/silcapi.h,
	  lib/silcclient/protocol.c, lib/silcclient/command.c and
	  silc/client_ops.c.

	  Added SilcAskPassphrase callback that the application calls
	  to deliver the passphrase to the library.

	* Changed the SKE protocol's SilcSKEVerifyCb to be asynchronous.
	  The public key verification and especially a certificate
	  verification is asynchronous procedure.

	  Added new SILC_SKE_STATUS_PENDING status to indicate the
	  request is pending and a callback will be called to finalize
	  the request.

	  Added also SILC_SKE_STATUS_PUBLIC_KEY_NOT_PROVIDED status to
	  indicate that remote end did not send its public key (or
	  certificate), even though we require it.  Added check for this
	  condition in the SKE.  This was a security bug, now fixed.

	  Defined new SilcSKEVerifyCbCompletion callback that is called
	  when the verification process is completed.

	  The affected files lib/silcske/silcske_status.h and
	  lib/silcske/silcske.[ch].

	* Changed the verify_public_key client operation to be async
	  as well.  Defined SilcVerifyPublicKey callback that is used to
	  indicate the success of the public key verification process.

	  Changed the server and client to use the new async client 
	  operations.

	* Changed the Irssi SILC client's internal scheduler to be called
	  twice as many times as it used to be.  As a result the client
	  should be a bit faster now.  Affected file is
	  irssi/src/silc/core/silc-core.c.

	* Added support to Irssi SILC client of asynchronous public key
	  verification and passphrase inquiry.  Affected file is
	  irssi/src/silc/core/silc-core.c.

Fri May 25 14:38:38 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Do not say "You have left channel %s" in client library.
	  Moved it to the application.  Affected files are
	  lib/silcclient/command.c and silc/client_ops.c.

	* Fixed silc_client_get_clients.  Command context was not
	  duplicated and was freed memory in the callback.  Affected
	  file lib/silcclient/idlist.c.

	* Do not say "you are now talking..." on JOIN command in the
	  client library.  The appliation must handle it.

	* Do not say ".. changed topic to" in command reply in the
	  client libary.  The application must handle it.

	* Fixed TOPIC command sending in the client library.

	* Fixed a memory leak in silc_client_command_free in the file
	  lib/silcclient/command.c.

Thu May 24 19:08:55 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Imported a modified version of Irssi client to the source tree.
	  The Irssi will be used to create a new client called
	  Irssi SILC.  Imported to irssi/.

	  Added silc_core_init_finish function to the Irssi.  Affected
	  file irssi/configure.in.

	  A lot changes in the Makefile.ams around the irssi tree.

Tue May 22 22:23:49 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Do not rehash if the new size is same as the old size of the
	  hash table, in the silc_hash_table_rehash*.  The affected file
	  lib/silcutil/silchashtable.c.

	* Replaced hash_table_del_by_context calls from the server
	  (when channel->user_list and client->channels) to the
	  hash_table_del as it is sufficient and faster.

Tue May 22 17:27:16 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_hash_table_list, silc_hash_table_get and the
	  SilcHashTableList structure to provide an alternative way to
	  traverse the hash table.  The affected files are
	  lib/silcutil/silchashtable.[ch].

	* Changed the server's idlist routines to use the hash table
	  routines to optimize the code.

Mon May 21 21:46:20 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Replaced the client entry's `channel' list and channel entry's
	  `user_list' list to hash tables for optimized lookup.  Changed
	  the code to use the hash table interface around the code. 
	  Affected file lib/silcd/idlist.[ch].

	* Added `auto_rehash' boolean argument to the function
	  silc_hash_table_alloc to indicate whether the hash table should
	  auto-rehash when it thinks is appropriate time.  It will
	  increase the hash table size if the there is twice as much
	  entries in the table than the size of the table, and will
	  decrease the size if there are twice as less entries than
	  the size of the table.

Mon May 21 09:51:11 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed silc_xxx_get_supported to not crash at some circumstances.

Sun May 20 13:45:58 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* silc_idcache_purge_by_context deletes the entry now by context
	  as it is supposed to do.  Affected file lib/silccore/idcache.c.

	* Send the ERR_NO_SUCH_NICK in the WHOIS command reply if the
	  client is not anymore valid (WHOWAS givens the info) and not
	  the ERR_NO_SUCH_CLIENT_ID if the nickname still exists.

Sat May 19 16:30:03 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Removed the `data' and `data_len' arguments from the ID Cache
	  interfaces and added `name' argument.  ID Cache does not handle
	  anymore the binary data only a names associated with given ID.

	* When hashing a Client ID with silc_hash_id the entire ID is
	  not hashed anymore, instead only the hash of the Client ID is
	  hashed.  This way we can access the Client ID from the cache
	  with Client ID but with the hash of the ID (which is a hash of
	  the nickname) as well without any difference in performance.

	  Added also silc_idcache_find_by_id_one_ext to do one on one 
	  searching when we have the actual ID.  Added also function
	  silc_hash_client_id_compare.  The affected files are
	  lib/silccore/idcache.[ch] and lib/silcutil/silcutil.[ch].

	* When hashing the name associated with a ID it is always done
	  in lowercase.  This way we can access the cache without worrying
	  about case-sensitivity, even though, for example nicknames are
	  case sensitive.

	* Fixed a bug in server with channel message sending.  It put
	  wrong ID type as destination ID.  The affected file 
	  silcd/packet_send.c.

	* silc_idcache_del_by_context now deletes from all hash tables
	  by context.  Affected file lib/silccore/idcache.c.

Fri May 18 17:42:00 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed the client library to use the new ID Cache interface.
	  Changes around the source tree.

	* Added silc_hash_table_rehash_ext to rehash with specific
	  hash function.  Affected file lib/silcutil/silchashtable.[ch].

	* Added silc_hash_string_compare to compare two strings in the
	  hash table.  Affected file lib/silcutil/silcutil.[ch].

Fri May 18 11:18:45 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new function silc_idcache_del_by_context into the
	  lib/silccore/idcache.[ch].

	* Changed the server's ID list routines to use the new ID Cache
	  interface.  Changes around the source tree.

Fri May 18 08:35:31 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_hash_table_del[_by_context]_ext functions in to the
	  lib/silcutil/silchashtable.[ch].

	  Removed silc_hash_table_find_all* routines and added new
	  silc_hash_table_find_foreach to replace them.

	  Added silc_hash_table_replace_ext function as extended
	  replacing function.  Separated the simple hash table interface
	  from the extended hash table interface in the file
	  lib/silcutil/silchashtable.h.

	* Fixed minor bugs and changed it to use some of the new
	  hash table functions in lib/silccore/idcache.c

Thu May 17 18:15:12 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new function silc_hash_table_find_all to return all keys
	  in the hash table by the specified key.  As the hash table is
	  collision resistant it also makes it possible to have several
	  duplicate keys in the hash table.  This function may be used to
	  find all of the keys from the hash.

	  Added user_context arguments to the SilcHashFunction,
	  SilcHashCompare and SilcHashDestructor to deliver user specified
	  context.

	  Added new fuctions silc_hash_table_find[_all]_ext to do
	  extended lookup with specified hash and compare functions and
	  specified user contexts.

	  Added new function silc_hash_table_add_ext to add the key
	  with specified hash function and user context.

	  Added new function silc_hash_table_foreach to traverse all
	  entrys in the hash table.  Added SilcHashForeach callback
	  function.

	  Added new function silc_hash_table_del_by_context to delete
	  the entry only if the context associated with the key matches.

	  Affected files are lib/silcutil/silchashtable.[ch].

	* Removed silc_hash_[server/client/channel]_id and added just
	  silc_hash_id to the lib/silcutil/silcutil.[ch].  Added also
	  silc_hash_id_compare to compare two ID's using as the hash table
	  comparison function.  Added also silc_hash_data to hash
	  binary data and silc_hash_data_compare to compare it.

	* Removed silc_idlist_find_client_by_hash as it is not needed
	  anymore.  Affected file silcd/idlist.[ch].

	* Rewrote the entire ID Cache system (in lib/silccore/idcache.[ch])
	  to use internally the SilcHashTable.  The new ID Cache is a lot
	  faster than the old one.  Some of the ID Cache interface was also
	  rewritten and obsolete and stupid functions were removed.

Wed May 16 23:03:30 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added entry_count field to the SilcHashTable to keep the number
	  of the entries in the table.  Implemented the function
	  silc_hash_table_rehash.  Added new function
	  silc_hash_table_count.  Affected file lib/silcutil/silchashtable.c.

	  Fixed a minor bug in silc_hash_table_free.

	* Added silc_hash_string, silc_hash_uint, silc_hash_ptr,
	  silc_hash_client_id, silc_hash_server_id and silc_hash_channel_id
	  into the lib/silcutil/silcutil.[ch].

Wed May 16 20:02:47 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented a collision resistant hash table into the
	  lib/silcutil/silchashtable[ch].  See the header and the source
	  for the SilcHashTable API.

Tue May 15 22:05:46 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Merged dotconf version 1.0.2 into lib/dotconf.

Sun May 13 19:32:09 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Do not compile anything in lib/silcsim/* if the SIM support
	  is not enabled.  The tree should now compile without problems
	  under cygwin.

Thu May 10 22:49:51 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Compiled the SILC under cygwin.  Compiled and tested briefly
	  without problems.  More tests needed.  The SIMs didn't compile
	  though.

	* Added various #ifdef HAVE_* stuff to lib/silccrypt/silrng.c.

	* Fixed possible crash in silc_get_username in the
	  lib/silcutil/silcutil.c.

Tue May  8 09:04:03 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a va_arg in silc/client_ops.c.

	* Oops, RC5 routines were named AES and caused some problems
	  when not using SIM's.  Affected file lib/silccrypt/rc5.c.

Sun May  6 13:59:48 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new SilcIDIP structure into the lib/silccore/id.h and
	  replaced the old `ip' fields from all SILC ID's to that type.
	  This is a step towards IPv6 support.

	  The silc_id_get_len takes now the ID as an extra argument.
	  The silc_id_id2str, silc_id_str2id and silc_id_dup now supports
	  both IPv4 and IPv6 based ID's.

	  The affected files are lib/silccore/id.[ch] and other files
	  around the tree using these routines.

	* Removed the ID length arguments in server from various 
	  silc_server_send_notify_* routines -> they are not needed 
	  anymore.

Sat May  5 13:56:33 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed memory leak in silc_encode_pem_file in the file
	  lib/silcutil/silcutil.c.

Thu May  3 21:23:50 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Check minor version as well in the SKE.  Affected files are
	  silcd/protocol.c and lib/silcclient/protocol.c.

	* Added --identifier option to the server so that an identifier
	  can be when creating the public key for the server.  Affected
	  file is silcd/silcd.c.

	* Fixed minor decoding bug in silc_pkcs_decode_identifier in
	  lib/silccrypt/silcpkcs.c.

Wed May  2 20:50:49 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Register default ciphers and stuff when using -C option with
	  the server.  Affected file sildc/silcd.c.

	* Put back the servers public key filename format, it is better
	  than the new one.  For now, the client keys are saved with the
	  new filename format.  The affected file silc/client_ops.c.

	* Implemented the Cipher API for the rest of the ciphers that
	  did not implement it or implemented it the wrong way.

Wed May  2 13:31:26 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Register default ciphers and stuff when using the -S option
	  in the client.  Affected file silc/silc.c.  Same also when
	  creating new key pair with -C option.

Tue May  1 14:18:13 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the silc_verify_public_key client operation function to
	  save the public keys differently.  The fingerprint is now 
	  used as filename and not the hostname.  This way also the
	  client keys are saved uniquely and not with hostnames.  The
	  affected file is silc/client_ops.c.

	* Trimmed the silc_hash_fingerprint function to remove extra
	  whitespaces from the end of the fingerprint.  The affected
	  file is lib/silccrypt/silchash.c.

	* Updated TODO.

	* Added silc_cipher_register_default function to register all
	  default ciphers.  It can be used when configuration files
	  does not exist and the application does not want any specific
	  ciphers in any specific order.

	  The SilcDList is now used as silc_cipher_list dynamically
	  allocated cipher list.  Removed the static list all together
	  and now all ciphers must be allocated to the dynamic list.
	  The silc_cipher_alloc routine was changed to check only the
	  dynamic list.

	  All silc_cipher_* routines that used to return int returns
	  now bool.

	  The affected files lib/silccrypt/silccrypt.[ch].

	* The same thing was done to silc_hash_* as for silc_cipher_*
	  routines.  Affected files lib/silccrypt/silchash.[ch].

	* The same thing was done to silc_pkcs_* as for silc_cipher_*
	  routines.  Affected files lib/silccrypt/silcpkcs.[ch].
	  Added also silc_pkcs_[un]register[_default] functions.
	  Removed the data_context from the PKCS API.

	* Added silc_hmac_register_default function to register default
	  hmacs.  Affected files lib/silccrypt/silchmac.[ch].  Added also
	  SILC_ALL_HMACS macro that can be used with silc_hmac_unregister
	  to unregister all hmacs at once.

	* Register the default ciphers, hash functions, PKCSs and HMACs
	  if client's configuration file does not exist.  The affected
	  file silc/silc.c.

	* The client did not load the hash functions from the SIM
	  modules at all.  Added support for this.  Affected file is
	  silc/clientconfig.c.

	* When decoding public key with silc_pkcs_public_key_decode, check
	  the supported algorithm only if PKCS are registered.  Affected
	  file lib/silccrypt/silcpkcs.c.  The same was done with the
	  silc_pkcs_private_key_decode.

	* Fixed the SILC List routines to keep the list always in order.
	  It used to change the list's order when traversing the list but
	  not it preserves the order.  Affected file lib/trq/silclist.h.

Mon Apr 30 17:29:03 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added the client library to use the SilcSocketConnection's
	  reference counter (by silc_socket_dup) to prevent the bug that
	  the socket object may be freed underneath async operation.

	* The name resolv library checking fixes in the configure.in.pre.
	  The patch by salo.

	* Created new version of the protocol drafts for future
	  development. The -03 drafts are the ones that will be changed
	  in the trunk now and the -02 will remain as they are.

	* Send list of CUMODE notifys to the router when announcing
	  the channel users to the router.  Affected file silcd/server.c.
	  If the router receiving channel founder CUMODE for a channel
	  that already has channel founder it will send CUMODE notify
	  to the sender to remove the channel founder rights from the
	  announced client.  Affected file silcd/packet_receive.c.

	* The CUMODE notify may now use Server ID as well as the entity
	  who changes the mode.  Updated protocool specs.

	* Updated INSTALL and README files.

Sun Apr 29 23:17:50 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* New web pages in the http://silc.pspt.fi.  The pages was
	  designed by salo.

	* Updated CREDITS.

Sun Apr 29 13:33:41 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented the [DenyConnectin] config section in the server.
	  Added silc_server_config_denied_conn to check whether incoming
	  connection is denied.  Affected file silcd/serverconfig.[ch].

	* Do not check the ports when checking the incoming configuration
	  data if the port is 0, meaning any.  Affected file is
	  silcd/serverconfig.c.

Fri Apr 20 18:58:43 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed buffer overflow in silc_string_compare in the file
	  lib/silcutil/silcutil.c.

	* Fixed double free in silc_server_command_leave in the file
	  silcd/command.c.

Fri Apr 20 14:00:11 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the version checking in the server.  Affected file is
	  silcd/protocol.c.

Thu Apr 19 19:52:46 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the configuration data fetching when accepting new
	  connections in the server.  Affected file silcd/server.c.

Thu Apr 19 11:40:20 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added `sender_entry' argument to the function
	  silc_server_packet_relay_to_channel so that we can check
	  whether some destination actually belongs to the same route
	  the sender belongs (ie, we must not resend the packet to the
	  sender).  Affected file silcd/packet_send.[ch].

	* Added `servername' field to the SilcClientEntry in the server
	  to hold the name of the server where client is from.  Affected
	  file is silcd/idlist.h.

Wed Apr 18 22:19:03 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Moved the channel message encrypting in the router betwen
	  router connections from silc_server_channel_message to the
	  silc_server_packet_relay_to_channel since we want to check
	  whether we have anybody channel before encrypting anything.
	  Affected files silcd/packet_[receive/send].c.

Tue Apr 17 21:18:19 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the [AdminConnection] server config section to support
	  multiple entries.  Affected file silcd/serverconfig.c.

	* Added support into the server to check the validity of the
	  incoming connection before executing any KE or authentication
	  protocols.

	* The connection configuration is now saved to the KE and 
	  connection auth protocol contexts and not fetched anymore in 
	  the protocol.  Affected files silcd/server.c, silcd/protocol.[ch].

	* The local hosts listenning address and port is also resolved
	  now when starting the server.  We want to have the socket object
	  to include the real address and port for the listener.  Added
	  new function silc_net_check_local_by_sock into the files
	  lib/silcutil/silcnet.[ch].

	* Fixed a broadcast bug in server -> do not broadcast if we
	  are standalone.

	* Fixed a routing bug.  Do not route broadcast packets ever.
	  Broadcast packets must be processed always and not routed since
	  they may be destined to some other host than yourself and thus
	  would get routed without no good reason.  Affected file is
	  silcd/server.c.

	* Added function silc_server_config_is_primary_route to check
	  whether primary router connection has been configured (a router
	  configuration that we are initiating).  If there is not, we 
	  will assume that there is only two routers in the SILC network
	  and we will use the incoming router connection as our primary
	  route.  Affected files silcd/serverconfig.[ch], silcd/server.c.

	* Changed the order of the broadcasting.  Broadcast _after_ the
	  packet has been processed not before.  Affected file is
	  silcd/server.c.

	* Fixed a [ClientConnection] parsing bug.  The port was never
	  parsed correctly thus resulting to port 0.  Affected file
	  silcd/serverconfig.c.

	* Fixed silc_server_send_notify_args -> it ignored the `broadcast'
	  argument and did not set the broadcast packet flag.  Affected
	  file silcd/packet_send.c.  Fixed same bug in the function
	  silc_server_send_notify as well.

	* If we receive NEW_ID packet for our own ID in the server, ignore
	  the packet.

Mon Apr 16 12:10:33 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Updated TODO.

	* Removed the nickname from the Private Message Payload.
	  Updated the code and the protocol specs.

	* Updated protocol specs for submitting to the IETF.

	* Tweaked the Random Number Generator a bit.  Affected file
	  lib/silccrypt/silcrng.c.  Exported a new function
	  silc_rng_[global]_add_noise which can be used to add more
	  noise to the RNG.

Sat Apr 14 16:21:32 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Do not parse packets with different timeout when protocol
	  is active -> may cause problem with rekey.  Affected file
	  silcd/server.c.

	* When server receives signoff notify it must not create
	  new channel key if the client is on any channels since the
	  sender of the signoff notify will create it.

Fri Apr 13 17:12:46 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added printing of error messages during SKE protocol from the
	  failure packet sent by server during SKE.  Affected file
	  silc/client_ops.c.

	* Removed the client's failure_callback handling with timeout
	  and handle it immediately when received.

	* The SKE library returned wrong type in SUCCESS and FAILURE 
	  packets.  They must be 32 bit MSB not 16 bit MSB.

Fri Apr 13 00:09:08 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Ok, rewrote the logic of the re-key and now it seems to work.
	  I tested it on high traffic with frequent re-keys without
	  problems.  Added hmac_receive (and renamed hmac to hmac_send)
	  in SilcClientConnection in lib/silcclient/client.h and
	  in SilcIDListData in silcd/idlist.h.  Also, removed the
	  SilcPacketParserContext's cipher and hmac fields as they are
	  not needed anymore and actually caused some problems when
	  the ciphers and hmac's changed underneath the packet parser.

Thu Apr 12 14:42:51 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* If re-key protocol is active then process the incoming packets
	  synchronously since we must assure that icoming packets encrypted
	  with the old key is processed before the new keys is set to
	  use.  This is true other packets than for REKEY packets.
	  Affected file silcd/server.c.  The same was done to client library
	  as well, affected file lib/silcclient/client.c.

Thu Apr 12 12:01:52 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed bug in client and server to accept the force send if
	  the packet is send from silc_[server/client]_packet_process
	  function.  Otherwise the packets are never delivered, oops.

Wed Apr 11 22:10:15 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Disable force sending of packets when REKEY protocol is active.
	  We must assure that no packet is sent directly when rekey is
	  performed.  All packets must be sent through packet queue.
	  Added macro SILC_SERVER_IS_REKEY to silcd/server.h and
	  SILC_CLIENT_IS_REKEY to lib/silcclient/client.h.  Affected
	  function is silc_[server/client]_packet_send_real to check
	  the situation.

	* Replaced the SIM paths from example config files to 
	  /usr/local/modules.  Also, make install creates now
	  /usr/local/silc/logs directory to hold all the SILC server
	  logs.

Wed Apr 11 16:59:59 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Made the configure.in.pre work on Solaris.  Patch by salo.

	* Made all ciphers compatible with non-x86 machines.  Defined
	  CBC mode macros into lib/silccrypt/ciphers_def.h.

Tue Apr 10 20:32:44 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the make install.

Tue Apr 10 16:20:34 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* When MAC computation fails the silc_packet_decrypt returned 0
	  even though it was supposed to return -1.  Fixed this.  The
	  affected file is lib/silccore/silcpacket.c.

	* Do not replace the config files in /etc/silc (in make install)
	  if they already exist.  Affected file ./Makefile.am.

	* Do not send re-key packets immediately but through packet queue.
	  Affected file silcd/protocol.c and lib/silcclient/protocol.c.

	* Changed silc_net_check_host_by_sock to return FALSE if the
	  IP/DNS could not be resolved.  Though, it returns the IP address
	  now even if it could not resolve it (but returns also FALSE).
	  Affected file lib/silcutil/silcnet.[ch].

Mon Apr  9 21:54:44 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_pkcs_decode_identifier to decode the public key's
	  identifier.  Affected file lib/silccrypt/silpkcs.[ch].
	  Added also silc_pkcs_free_identifier.  Added also new context
	  SilcPublicKeyIdentifier.

	* Added -S option to the silc client.  It is used to dump the
	  contents of the specified public key file.

	* Changed the PKCS api to return the public key length when
	  setting the public key.

	* Fixed a fatal bug in the public and private key file loading.
	  Affected file lib/silccrypt/silcpkcs.c.

	* Execute the packet parsing for client with zero (0) timeout
	  if the protocol is active.  Affected file silcd/server.c.

Sun Apr  8 19:30:56 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Made the key generation options to the silcd program.  Added
	  -C option, equivalent to client's option.

	* Added new [ServerKeys] config section to the server.  It
	  configures the server's public and private key.

	* Defined generic Public Key Payload into the protocol
	  specification to send specific type of public keys and
	  certificates.

	* Defined new command SILC_COMMAND_GETKEY to fetch a client's
	  public key or certificate.

	* Implemented the GETKEY command to the server and to the
	  client library and on user interface.

Sun Apr  8 01:37:21 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Made preliminary `make install' work.

Thu Apr  5 17:42:30 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added SilcServerRekey context into silcd/idlist.h.

	* Added the PFS support as defined in the specification to the
	  SKE protocol.  Affected files lib/silcske/*.c.

	* Added `ske_group' field to the SilcServerRekey context to hold
	  the number of the SKE group that is used with PFS in re-key.
	  Affected file silcd/idlist.h.

	* Added PFS re-key support to the server.  Affected file is
	  silcd/protocol.c.

	* Added silc_protocol_cancel to cancel execution of the next
	  state of the protocol.  Affected file is
	  lib/silccore/silcprotocol.[ch].

	* Added the re-key support with and without PFS to the client
	  library.  Re-key is performed once in an hour, by default.

	  Added new protocol type SILC_PROTOCOL_CLIENT_REKEY.
	  Added silc_client_rekey_callback and silc_client_rekey_final.
	  Affected files are lib/silcclient/protocol.[ch] and
	  lib/silcclient/client.[ch].

	* Removed the `hmac_key' and `hmac_key_len' fields from the
	  SilcClientConnection structure; not needed.  Affected file is
	  lib/silcclient/client.h.

	* Updated TODO.

Wed Apr  4 16:32:31 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Do not ask whether user wants to use the negotiated private key
	  for private messages, just use it.  Affected file is 
	  silc/local_command.c.

	* Added `send_enc_key' and `enc_key_len' fields to the 
	  SilcIDListData structure since they are needed in the re-key
	  phase.  Affected file is silcd/idlist.[ch].

	* Implemented the simple re-key protocol into the server.
	  Affected files silcd/server.c and silcd/protocol.[ch].  The
	  re-key will be performed once in an hour, by default.

	  Added new protocol type SILC_PROTOCOL_SERVER_REKEY.
	  Added silc_server_rekey, silc_server_rekey_callback and
	  silc_server_rekey_final.

	* Removed Tunneled flag from the protocol.  Updated the code
	  and the specifications.

	* Adde `pfs' field to the SilcIDListData to indicate whether
	  the PFS is to be performed in the re-key.  Affected file is
	  silcd/idlist.h.

Tue Apr  3 21:52:42 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Defined uint8, int8, uint16, int16, uint32, int32, uint64 and
	  int64 of at least the xintXX size.  If void * is less that 4
	  bytes uint32 * will be used.  Defined bool as boolean.

	* Changed _ALL_ unsigned long and unsigned int to uint32, 
	  unsgined short to uint16 in the source tree.

	* Fixed a fatal bug in silc_server_remove_clients_by_server.  Do
	  not handle clients that has entry->data.registered == FALSE.
	  They are not in the network anymore.  Affected file is
	  silcd/server.c.

Tue Apr  3 16:39:19 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented the sending of the SERVER_SIGNOFF notify in the
	  server.  Affected file is silcd/server.c.

	* Added silc_server_send_notify_args into silcd/packet_send.[ch].
	  Added also silc_notify_payload_encode_args into the
	  lib/silccore/silcnotify.[ch].

	* Implemented ther SERVER_SIGNOFF notify handling in the server.
	  Affected file silcd/packet_receive.c.

	* Implemented the SERVER_SIGNOFF notify handling in the client
	  library.  Affected file lib/silcclient/client_notify.c.  Also,
	  implemnted the printing of the SERVER_SIGNOFF info to the
	  application.  Affected file silc/client_ops.c.

	* The silc_idlist_del_server now returns TRUE or FALSE to indicate
	  if the deleting was successful.  Affected file silcd/idlist.[ch].

	* Added support for public key authentication in the connection
	  authentication protocol in the client library.  Affected file
	  lib/silcclient/protocol.c.

	* Changed the server's silc_idlist_get_clients_by_* interface
	  to support already allocated array so that new entries may be
	  added to pre-allocated array.  Affected file silcd/idlist.[ch].
	  This fixes some bugs with WHOIS, WHOWAS and IDENTIFY commands
	  and command replies.

	* All command reply functions in the server now calls the 
	  pending command callback even if error occured.  This way the
	  error will be delivered to the client as well.  Affected files
	  silcd/command.c and silcd/command_reply.c.

	* Fixed INFO command to return local server's info if no server
	  was provided.  Affected file lib/silcclient/command.c.

	* Removed RESTART command for good.  Updated the code and the
	  protocol specs.

	* Rewrote parts of the task system.  It is a bit simpler now.
	  Removed unsued task priorities. The affected files are
	  lib/silcutil/silctask.[ch].

Mon Apr  2 20:02:33 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Moved the USERS printing from the library to the application.
	  Affected files lib/silcclient/command.c and silc/client_ops.c.

Mon Apr  2 13:13:23 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Updated TODO.

	* Added channel key re-key support.  The re-key is perfomed
	  only by the router and is done once in an hour.  Added `rekey'
	  field to the SilcChannelEntry in the server.  Affected files
	  silcd/server.c and silcd/idlist.h.

	* Added silc_task_unregister_by_context into the file
	  lib/silcutil/silctask.[ch].

Sun Apr  1 19:49:34 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added SILC_UMODE_GONE mode to indicate when the client is not
	  present in the SILC network.  Added also support to the local
	  command AWAY that will set this mode.  Added support of showing
	  "xxx is gone" in WHOIS command.  The USERS command shows the
	  gone status as well.

	* Fixed setting server and router operator privileges in the
	  server's UMODE command.  Affected file silcd/command.c.

	* Merged the SKE KE1 and KE2 payloads into one payload.  The
	  new KE payload is equivalent to the old KE2 payload.

	  Cleaned up the SKE Start Payload parsing.  It now uses the
	  simple buffer unformatting to do the parsing.  A lot faster
	  now.

	  Added new Mutual Authentication flag (SILC_SKE_SP_FLAG_MUTUAL)
	  to the SKE that is used to indicate whether both of the SKE
	  parties should perform authentication.  By default only the
	  responder performs authentication.  By setting this flag also
	  the initiator must do authentication.  By default it is unset
	  since in normal SKE case, client to server connection, only
	  the responder should do authentication.  When doing SKE between
	  two clients both should perform authentication.  Updated the
	  code and the protocol specs.

	* A little fix to IDENTIFY command in the server.  Search the
	  client first by hash not nickname.  Affected file is 
	  silcd/command.c.

	* Fixed the silc_client_close_connection to support closing
	  the client to client connections wihtout deleting too much
	  data.  Affected file lib/silcclient/client.c.

	* Fixed a fatal bug in server and client; if KE1 or KE2 packets
	  are received if protocol used to be active but is not anymore
	  the application would crash due to NULL pointer dereference.
	  Affected files silcd/server.c and lib/silcclient/client.c.

	* Added `hash' field to the SilcClientConnection to include
	  the hash function negotiated in the SKE protocol.

	* Added new channel mode SILC_CMODE_FOUNDER_AUTH that is used
	  to set the channel founder authentication data.  A client can
	  claim the founder rights later by providing the authentication
	  data to the CUMODE command using SILC_CUMODE_FOUNDER mode.
	  This way the channel founder can regain the channel founder
	  privileges even it is left the channel.  This works only on
	  local server and the client must be connected to the same
	  server to be able to regain the founder rights.  Updated the
	  protocol specs accordingly.

	  Added support to the CMODE command in the client to set the
	  founder auth data.  Read the README to see how to set it.

	  Added support to the CUMODE command to claim the founder
	  rights.  Read the README to see how to do it.

	  Added support for the founder authentication to the Channel
	  Entry in the server.  Affected file silcd/idlist.h.

	  Added support for the SILC_CMODE_FOUNDER_AUTH mode in the
	  server's CMODE command.  Affected file silcd/command.c.

	* Added the following new functions into lib/silccore/silcauth.[ch]:
	  silc_auth_get_method and silc_auth_get_data.	  

	* The server now saves the remote hosts public key to the
	  SilcIDListData pointer.  Affected file silcd/protocol.c.

	* The normal server now does not remove the channel entry from
	  the cache if the founder authentication data is set.  It used
	  to remove it if the founder was the last one on the channel on 
	  the server and left the channel.  The auth data is saved and
	  if the channel is re-joined later the old entry is used with
	  the old auth data.  Affected files silcd/command_reply.c and
	  silcd/server.c.

	* Removed the `pkcs' field from the SilcIDListData structure
	  in the server; it is not used.  Affected file silcd/idlist.h.

Sat Mar 31 15:38:36 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed packet processing on slow links.  Partial packets were
	  never re-processed because the incoming data buffer was cleared
	  by the application.  Application must not directly clear the
	  sock->inbuf, the packet processing routines handle it.  Fixed
	  this in client library and in server.

Fri Mar 30 16:35:27 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the WHOIS and IDENTIFY send reply function to really
	  check whether to send list or just one entry.  Affected file
	  silcd/command.c.

	* Cleaned up the LEAVE command's channel key distribution.  The
	  affected file silcd/command.c.

	* Changed CMODE_CHANGE's <Client ID> to <ID Payload> as server
	  can enforce the channel mode as well.  In that case the ID
	  includes the ID of the server.  The code now enforces the
	  mode change if the router have different mode than the server.

	* The notify client operation with CMODE_CHANGE notify can now
	  return NULL client_entry pointer if the CMODE was not changed
	  by client.  Application must check for this.

	* Added <Server ID> argument to INFO command to support server
	  info fetching by Server ID.

	* Added silc_server_announce_get_channel_users to get assembled
	  packets of channel users of the specified channel.  Affected
	  file silcd/server.[ch].

	* Fixed bug in CHANNEL_CHANGE notify in the server.  The new ID
	  was freed underneath the ID Cache.

	* Re-announce clients when the server received CHANNEL_CHANGE
	  notify from the router.  Affected file silcd/packet_send.c.

Thu Mar 29 19:10:28 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a fatal bug when client does /join 1 2 3 4 5 6 the server
	  crashed since it did not handle the fact that there is no cipher
	  called "3" and didn't check the error condition.  Now fixed.

	* Added SILC_MESSAGE_FLAG_REQUEST message flag as generic request
	  flag.  It can be used to send message requests.

Thu Mar 29 12:26:25 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented the RESTART command in the client.

	* Added SILC_MESSAGE_FLAG_NOTICE message flag for informational
	  notice type messages.  Added notice printing to the user
	  interface.

	* The channel keys are not re-generated if the channel's mode
	  is PRIVKEY, ie private key on the channel exists.  Affected
	  files silcd/server.c and silcd/command.c.

	* Fixed a little bug in channel message delivery when channel
	  private keys are set in the server.  Affected file is
	  silcd/packet_send.c.

	* Changed the setting on channel->on_channel = TRUE from the
	  silc_client_save_channel_key to the JOIN command reply.  The
	  key payload is not received if the private channel key is set.
	  Affected file lib/silcclient/command_reply.c and the
	  lib/silcclient/client_channel.c.

	* When the CMODE_CHANGE notify is sent and the channel private
	  key mode is removed the channel key must be re-generated in
	  other cells as well.  Added this support for the router in the
	  silcd/packet_receive.c.

	* Added new local command NOTICE to send notice message on
	  channel.  Affected file silc/local_command.[ch].

Wed Mar 28 23:55:54 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new local command ME to the client.  It is used to send
	  message to a channel with SILC_MESSAGE_FLAG_ACTION to indicate
	  some action.  Affected file silc/local_command.[ch].

	* Changed channel_message and private_message client operations 
	  to deliver the message flags to the application.  Added also
	  the `flags' arguments to the silc_client_send_channel_message
	  and silc_client_send_private_message functions.  Affected file
	  silcapi.h.

Wed Mar 28 20:50:47 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Redefined the Private Message Payload to support private message
	  keys and to support the new private message flags.  Updated
	  the protocol specs.  Flags makes it possible to have for example
	  CTCP style messages.

	* Added new type SilcPrivateMessagePayload and defined an API
	  for it in the lib/silcclient/silcprivate.[ch].

	* Tested private message private keys successfully.  Tested the
	  private message key set, unset and list commands with the new
	  KEY command.

	* Redefined the Channel Message Payload to include the channel
	  message flags (equal with private message flags) to support
	  for example CTCP style messages.

	* Defined some of the message (for channel and private message)
	  flags.  Updated the protocol specs and added the flags to the
	  lib/silccore/silcchannel.h.  The type is SilcMessageFlags.

Wed Mar 28 15:52:36 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added SilcKeyAgreementStatus type to the key agreement routines
	  to indicate the current status and error if one occured.
	  The status types are defined in the lib/silcclient/silcapi.h.

	* Added new local command KEY that is used to set and unset private
	  keys for channels, set and unset private keys for private messages
	  with remote clients and to send key agreement requests and
	  negotiate the key agreement protocol with remote client.  The
	  key agreement is supported only to negotiate private message keys,
	  it currently cannot be used to negotiate private keys for channels,
	  as it is not convenient for that purpose.

	* Fixed a minor pending callback setting bug in the function
	  silc_client_get_client_by_id_resolve, now the function works.
	  Affected file lib/silcclient/idlist.c.

	* Added function silc_net_get_local_port to get local bound
	  port by socket.  Added to lib/silcutil/silcnet.[ch].

	* Added `sockets' and `sockets_count' fields to the SilcClient
	  object.  They hold the sockets of the listenning sockets in
	  the client.  Listenning sockets may be for example the key 
	  agreement server.  Affected file lib/silcclient/client.[ch].
	  Added functions the silc_client_add_socket and the
	  silc_client_del_socket.  They are exported to the application
	  as well.

	* Added ~./silc/clientkeys to support other client's public keys.

	* Renamed verify_server_key client operation to verify_public_key
	  and added one argument to indicate the type of the connection
	  (server, client etc.).

Tue Mar 27 22:22:38 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_server_connection_auth_request to handle the
	  incoming CONNECTION_AUTH_REQUEST packet.  Affected file is
	  silcd/packet_receive.[ch].

	* Added silc_server_send_connection_auth_request into the
	  silcd/packet_send.c to send the connection auth request packet.

	* Cleaned up the silcd/protocol.c a bit and fixed some memory
	  leaks.

	* Fixed the public key authentication in responder side in the
	  server.  The `auth_data' pointer includes the SilcPublicKey
	  not the path to the public key.  Affected file silcd/protocol.c.

	* Implemented the public key authentication in the initiator side
	  in the server.  Affected file silcd/protocol.c.

	* Removed the [RedirectClient] config section from the server
	  configuration.  Is not needed and I don't want to implement it.

Tue Mar 27 12:49:56 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Cleaned up the CMODE command in the server.  It now works
	  correctly and supports all the modes defined in the protocol.
	  Affected file is silcd/command.c.

	* Added `hmac_name' field to the SilcChannelEntry in the server
	  to hold the default HMAC of the channel.  It can be set when
	  creating the channel (with JOIN command).  Affected files
	  silcd/idlist.[ch].

	* Added <cipher> and <hmac> argument to the CMODE_CHANGE notify
	  type to indicate the change of the current cipher and hmac
	  on the channel.  Client can safely ignore the <cipher> argument
	  (if it chooses to do so) since the CHANNEL_KEY packet will 
	  force the channel key change anyway.  The <hmac> argument is
	  important since the client is responsible of setting the new
	  HMAC and the hmac key into use.

	* Fixed the CMODE command in the client library as well.

	* Tested CMODE command in router environment successfully.

Mon Mar 26 14:39:48 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Show the version of the remote client (or server) when connecting
	  to the server.  It is logged to the log file.  Affected file
	  is silcd/protocol.c.

	* Fixed the KILLED notify handling in the client library.  The
	  client must be removed from all channels when receiving the
	  KILLED notify.

	  Also, do not remove the client entry when giving the KILL 
	  command but when the KILLED notify is received.

	* Removed silc_idlist_find_client_by_nickname from the server.
	  Not needed anymore.  Affected files silcd/idlist.[ch].

	* Implemented the CHANNEL_CHANGE notify type handling to the
	  server.  Affected file silcd/server.c.

	* Updated TODO.

Mon Mar 26 12:11:14 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_server_send_notify_invite to send the INVITE
	  notify between routers.

	* Implemented the INVITE command correctly to the server.

	* Implemented the INVITE notify type handling in the server.

	* Implemented the INVITE command to the client library and on the
	  user interface.

Sun Mar 25 20:27:09 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added function silc_server_get_client_resolve to find the
	  client entry by ID from all ID lists and then resolve it
	  (using WHOIS) if it cannot be found.  Affected file is
	  silcd/server.[ch].

Sun Mar 25 13:52:51 EEST 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented the BAN command to the client library.

	* The JOIN command in the server now checks the invite list
	  and the ban list.

	* Changed the silc_command_reply_payload_encode_va and the
	  silc_command_payload_encode_va to support that if argument is
	  NULL it ignores and checks the next argument.  Affected file
	  lib/silccore/silccommand.c.

	* Added silc_server_send_notify_ban to send the BAN notify
	  type between routers.

	* Chaned the silc_notify_payload_encode to support that if 
	  argument is NULL it ignores and checks the next argument.
	  Affected file lib/silccore/silcnotify.c.

	* Tested ban lists in router environment successfully.

Sat Mar 24 14:47:25 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented BAN command to the server, in silcd/command.[ch].

	* Removed the BAN and INVITE_LIST modes from the CMODE command
	  in the server code.

	* Added function silc_string_match to regex match two strings.
	  Affected files lib/silcutil/silcutil.[ch].

Fri Mar 23 22:02:40 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Redefined parts of the SilcChannelEntry in the server to support
	  the new ban and invite lists.

Fri Mar 23 16:25:11 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Redefined the INVITE command.  The same command can be used to
	  invite individuals to the channel but also to manage the invite
	  list of the channel (to add to and remove from the invite list).
	  Updated the protocol specs.

	* Added new command SILC_COMMAND_BAN that can be used to manage
	  the ban list of the channel.  Updated the protocol specs.

	* Removed the channel modes: the SILC_CMODE_BAN and the 
	  SILC_CMODE_INVITE_LIST as they were a bit kludge to be included
	  in the CMODE command.  The equivalent features are now available
	  using INVITE and BAN commands.  Updated the protocol specs.

	* Added new SILC_NOTIFY_TYPE_BAN notify type to notify routers
	  in the network about change in the current ban list.  The notify
	  type is not used by the client.

	* Redefined parts of the SILC_NOTIFY_TYPE_INVITE command to 
	  support the invite lists.

Thu Mar 22 22:52:23 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new function silc_string_regexify that converts string
	  including wildcard characters into regex string that can
	  be used by the GNU regex library.  Added into the file
	  lib/silcutil/silcutil.[ch].

	  Added silc_string_regex_combine to combine to regex strings
	  into one so that they can be used as one regex string by
	  the GNU regex library.  Added into the file
	  lib/silcutil/silcutil.[ch].

	  Added silc_string_regex_match to match two strings.  It returns
	  TRUE if the strings match.  Added into lib/silcutil/silcutil.[ch].

Thu Mar 22 15:29:42 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Imported GNU regex to the soruce tree into lib/contrib.
	  Fixed some compiler warning from the regex.c.

Wed Mar 21 15:27:58 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed MOTD command in the server to work in router environment.

	* Fixed the MOTD command in the client library to support
	  the server argument in the command.

	* Added `nickname_len' argument to the silc_idlist_add_client
	  in the server, as the `nickname' argument may be binary data
	  (it may be hash).

	* Added silc_idlist_get_channels to return all channels from
	  the ID list.

	* Implemented LIST command to the server.  Affected file is
	  silcd/command.c.

	* Implemented the LIST command to the client library and on the
	  user interface.

	* Added [<user count>] argument to the LIST command reply.
	  With private channels the user count is not shown.

	* Updated TODO and README.

Tue Mar 20 21:05:57 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* The client entry's data.registered must be TRUE even with
	  global client entry on global client list.  The data.registered
	  is used to check whether the client is anymore in the network,
	  for example with WHOWAS command so it must be valid.

	* Fixed the WHOWAS command in the server.  It now actually works
	  in router environment.  Added function into silcd/command_reply.c
	  silc_server_command_reply_whowas_save.

	* Added silc_idlist_purge function to the silcd/idlist.c
	  to periodically purge the ID Cache.

	* Fixed INFO command in the server.  It works now in router
	  environment.  Added <server name> argument to the INFO command
	  reply.  Updated the protocol specs.

	* Fixed minor bug in silc_idcache_purge to not purge if the
	  expire value is zero.

	* Fixed various bugs in WHOIS and IDENTIFY command handling as
	  they were buggy because of the WHOWAS information.

	* Fixed local command MSG to handle the async resolving of 
	  the remote client properly.  It used to fail the first MSG.
	  Affected file silc/local_command.c.

	* Added `data_len' field to SilcIDCache context.

Tue Mar 20 16:29:00 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Update TODO.  Todo in commands in the server.

Tue Mar 20 15:45:14 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new notify type SILC_NOTIFY_TYPE_UMODE_CHANGE that is
	  used by routers as broadcast packet to inform other routers
	  about the changed user mode.

	  Implemented the notify handling in the server.  Affected file is
	  silcd/packet_receive.c.  Added the function 
	  silc_server_send_notify_umode to the silcd/packet_send.[ch].

	* Added new generic Channel Payload and deprecated the New Channel
	  Payload.  The New Channel Payload is now the generic Channel
	  Payload.

	* Added new argument `mode' to the silc_server_send_new_channel
	  as it is required in the Channel Payload now.

	* Renamed the SilcChannelPayload to SilcChannelMessagePayload
	  and created a new and real SilChannelPayload to represent the
	  new generic Channel Payload.  Implemented the encode/decode
	  for Channel Payload.  Affected file lib/silccore/silcchannel.[ch].

	* Added silc_server_get_client_channel_list to return the list
	  of channels the client has joined for WHOIS command reply.
	  Affected file silcd/server.[ch].

	* Implemented the channel list sending in the WHOIS command reply
	  in server and in the client.

	  Implemented the channel list displaying on the user interface
	  as well.  Affected file silc/client_ops.c.

	* Added silc_channel_payload_parse_list to parse list of Channel
	  Payloads.  It returns SilcDList list of SilcChannelPayloads.
	  Client for example can use this function to parse the list of
	  channels it receives in the WHOIS command reply.  The caller
	  must free the list by calling silc_channel_payload_list_free.
	  Affected files lib/silccore/silcchannel.[ch].

Mon Mar 19 21:39:15 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added one new argument <user mode> to the WHOIS command reply
	  to return the mode of the user in SILC.  Updated the protocol
	  specs.

	  Implemented it to the server and client.

Mon Mar 19 18:43:06 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the mode printing on the user interface on joining.
	  Affected file silc/client_ops.c.

	* Implemented the UMODE command and user modes in general to the
	  client library and to the user interface.

	* Implemented the UMODE command to the server.

	* The server now sends UNKNOWN_COMMAND error status if client sends
	  unknown command.  Affected file silcd/command.c.

	* All server commands now handle the command identifier the right
	  way when sending the command reply to the client.  The client can
	  use to identify the command replies with the identifier.

Mon Mar 19 16:13:07 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_server_get_client_route to resolve the route to
	  the client indicated by the client ID.  Affected file is
	  silcd/server.[ch].

	* Added silc_server_relay_packet as general function to relay
	  packet to arbitrary destination.  This deprecates functions
	  like _send_private_message_key, _relay_notify etc.  Affected
	  file is silcd/packet_send.[ch].

	  Removed silc_server_send_key_agreement, 
	  silc_server_send_private_message_key and
	  silc_server_packet_relay_notify functions from the file
	  silcd/packet_send.[ch].

	* Updated TODO.

	* Implemented the SILC_NOTIFY_TYPE_KILLED notify handling in the
	  server.  Affected file silcd/packet_receive.[ch].

	* Implemented the KILL command to the client.  Implemented the
	  SILC_NOTIFY_TYPE_KILLED notify handling in the client library.
	  Affected files lib/silcclient/command[_reply].c and
	  lib/silcclient/client_notify.c.  Implemented the KILL notify
	  printing in the user inteface.

	* Fixed a lot silc_parse_nick memory leaks from the client
	  library in the file lib/silcclient/command.c.

	* Changed the silc_server_send_notify_on_channels's `sender'
	  argument from SilcSocketConnection to SilcClientEntry to 
	  check the sender as entry and not as connection object and not
	  to send to the client provided as argument.  The affected file
	  is silcd/packet_send.[ch].

	* The notify packets that are destined directly to the client used
	  to not to be processed by the server.  Now changed that and the
	  server processes all notify packets.  After relaying the packet
	  to the client the notify packet is processed in the server.

	* The silc_server_free_client_data now checks whether there is
	  pending outgoing traffic for the client and purges the data to
	  the network before removing the client entry.

Sun Mar 18 21:02:47 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added SILC_NOTIFY_TYPE_KILLED notify type.  It is sent when
	  an client is killed from the SILC Network.  Updated the protocol
	  specs accordingly.

	  Added new function silc_server_send_notify_killed to the
	  silcd/packet_send.[ch].

	* Added function silc_server_packet_relay_notify to relay notify
	  packets that are destined directly to a client.  In this case
	  the server does not process the notify packets but merely relays
	  it to the client.  Affected file silcd/packet_send.[ch].

	  Added also silc_server_packet_process_relay_notify to check
	  whereto relay the notify.  Affected file is 
	  silcd/packet_receive.[ch].

	* Implemented the KILL command to the server.

	* Updated TODO.

	* Added the backup schema desgined last fall to the protocol
	  specs for everyone to see.  The specification is in the
	  *-spec-xx.txt draft and the packet type definitions for the
	  backup routers is in *-pp-xx.txt draft.  Thusly, added also
	  new packet type SILC_PACKET_CELL_ROUTERS.

	* A big security problem in the implementation discovered.  The
	  signoff of an client did not cause new channel key generation
	  which it of course should've done.  The channel keys must be
	  always re-generated when client leaves (or signoffs) the channel.
	  The silc_server_remove_from_channels funtion now handles
	  the channel key re-generation.

	* Added `sender' argument to the silc_server_send_notify_on_channels
	  to not to send the client provided as argument.  Affected file
	  silcd/packet_send.[ch].

Fri Mar 16 15:52:49 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented OPER and SILCOPER commands into the server and
	  the client library.

	* Added silc_auth_verify and silc_auth_verify_data to verify
	  the authentication directly from the authentication payload.
	  It supports verifying both passphrase and public key based
	  authentication.  Affected file lib/silccore/silcauth.[ch].

	* Added `hash' field to the SilcIDListData structure.  It is the
	  hash negotiated in the SKE protocol.  Affected file is
	  silcd/idlist.[ch].

	* Slight redesigning of the SilcAuthPayload handling routines.
	  Do not send SilcPKCS but SilcPublicKey as argument.

	* Implemented the public key authentication support to the
	  serverconfig.  The public key is loaded from the provided path
	  and saved as authentication data to void * pointer.  Thus,
	  changed the unsigned char *auth_data to void *auth_data;

	* Fixed SHUTDOWN command to send the reply before the server
	  is shutdown. :)  Affected file silcd/command.c.

	* Fixed fatal bug in CONNECT command.  The hostname was invalid
	  memory and server crashed.  Affected file silcd/command.c.

	* Fixed fatal bug in CLOSE command.  The server_entry became
	  invalid but was referenced later in the command.  Affected file
	  silcd/command.c.

Thu Mar 15 12:46:58 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed fatal bug in failure packet handling.  Server ignored
	  the failure and thus crashed when it came.

	* Updated TODO.

Wed Mar 14 20:37:35 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new SILC_CF_LAG_STRICT command flag that strictly forces
	  that the command may be executed only once in (about) 2 seconds.
	  The old SILC_CF_LAG flag is same but allows command bursts up
	  to five before limiting.

	  Added the support for CF_LAG and CF_LAG_STRICT flags to the
	  server code.  Various commands now includes the CF_LAG_STRICT
	  flag to disallow any kind of miss-use of the command.

	* Fixed the silc_buffer_unformat to not to allocate any data
	  if the length of the data is zero.  It used to allocate the
	  length + 1.  Affected file lib/silcutil/silcbuffmt.c.

Wed Mar 14 16:10:30 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed the format of AdminConnection configuration section
	  in the server.  Added username of the admin to the format.
	  Affected files silcd/serverconfig.[ch].

	  Added silc_server_config_find_admin into silcd/serverconfig.[ch]
	  to return admin configuration data by host, username and/or
	  nickname.

Wed Mar 14 13:18:16 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented WHOWAS command to the server.  Added the functions:

	  silc_server_command_whowas_parse,
	  silc_server_command_whowas_send_reply,
	  silc_server_command_whowas_from_client and
	  silc_server_command_whowas_from_server

	* Added <Client ID> argument to the WHOWAS command reply.  Updated
	  the protocol specs accordingly.

	* Implemented WHOWAS command and command_reply to the client
	  library.

	  Implemented the WHOWAS printing on the user interface.

Tue Mar 13 22:17:34 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new argument to the WHOWAS command reply, the real name.
	  It is an optional argument.  Updated the protocol specs.

	* Added SilcIDCacheDestructor callback that is registered when
	  the SilcIDCache is allocated.  The callback is called when
	  an cache entry in the ID Cache expires, or is purged from the
	  cache.  Added into lib/silccore/idcache.[ch].

	  Added silc_idlist_client_destructor to the silcd/idlist.[ch]
	  to destruct the client entries when the cache entry expires.
	  Other ID Cache's in server and in the client library ignores
	  the destructor.

	* If the ID Cache entry's `expire' field is zero then the entry
	  never expires.  Added boolean `expire' argument to the
	  silc_idcache_add function in the lib/silccore/idcache.[ch].
	  If it is TRUE the default expiry value is used.

	* Added silc_server_free_client_data_timeout that is registered
	  when client disconnects.  By default for 5 minutes we preserve
	  the client entry for history - for WHOWAS command.

Tue Mar 13 13:26:18 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added support to the server to enforce that commands are not
	  executed more than once in 2 seconds.  If server receives 
	  commands from client more frequently, timeout is registered
	  to process the commands.  Affected file silcd/command.c.
	  Added new function silc_server_command_process_timeout.

	* Changed NICK_NOTIFY handling in client library to check that
	  if the client's nickname was changed, so there is no need to
	  resolve anything from the server.

	* Removed error printing from the WHOIS and IDENTIFY commands.
	  If error occurs then it is ignored silently in the client library.
	  The application, however, may map the received error to 
	  human readable error string.  The application currently maps
	  the NO_SUCH_NICKNAME error to string.

	* Made the command status message public to the application.  Moved
	  them from lib/silcclient/command_reply.c to 
	  lib/silcclient/command_reply.h.  The application can map the
	  received command status to the string with the
	  silc_client_command_status_message function.

	* Added check to the server to check that client's ID is same
	  as the Source ID in the packet the client sent.  They must
	  match.

Tue Mar 13 12:49:21 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added dist-bzip hook to the Makefile.am to make bzip2
	  compressed distributions.

Mon Mar 12 18:43:38 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Server now enforces the maximum length for the nickname and
	  the channel as protocol specification dictates.  128 bytes for
	  nickname and 256 bytes for channel name.

	* Moved the WHOIS printing to the application.  The client libary
	  does not print out the WHOIS information anymore, the application
	  must do it.  Renamed silc_client_command_reply_whois_print to
	  the silc_client_command_reply_whois_save.

	  The client's idle time is also sent to the application now, and
	  the idle is shown on screen.

	* Added silc_client_command_reply_identify_save to save the
	  received IDENTIFY entries.

	* Do not check for channel private keys in message sending and
	  reception if the channel does not have the PRIVKEY mode set.
	  Affected file lib/silclient/client_channel.c.

Sun Mar 11 20:25:06 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a minor bug if WHOIS and IDENTIFY command parsing that
	  just surfaced after chaning the JOIN procedure.

Sun Mar 11 14:59:05 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_client_get_clients_by_list to get client entries
	  from Client ID list, that is returned for example by JOIN
	  and USERS command replies.  The application should use this
	  function for example when JOIN command reply is received to
	  resolve the clients already on the channel (library does not
	  do that anymore as USERS command reply is not used in the JOIN
	  procedure anymore).  Affected files lib/silcclient/silcapi.h and
	  lib/silcclient/idlist.c.

	* JOIN command reply and USERS command reply returns now SilcBuffer
	  pointers instead of unsigned char pointers when returning
	  the client list and mode list.

	* Added <Client ID> argument to the JOIN command reply, mainly
	  for the server to identify for which client the command was
	  originally sent.  Updated protocol specs accordingly.

	* Added SilcDlist private_key pointer to the SilcChannelEntry
	  in the client to support the channel private keys.  Affected
	  file is lib/silcclient/idlist.h.

	* Added SilcChannelPrivateKey argument to the function
	  silc_client_send_channel_message so that application can choose
	  to use specific private ke if it wants to.  If it is not provided,
	  the normal channel key is used, unless private keys are set. 
	  In this case the first (key that was added first) is used 
	  as the encryption key.

	* Implemented the support for channel private key handling.
	  Implemented the following functions:

	  silc_client_add_channel_private_key,
	  silc_client_del_channel_private_keys,
	  silc_client_del_channel_private_key,
	  silc_client_list_channel_private_keys and
	  silc_client_free_channel_private_keys

	  Affected file lib/silcclient/client_channel.c.

	* Added the support for the private keys in the channel message
	  sending and encryption and in the message reception and
	  decryption.  Affected funtions are
	  silc_client_send_channel_message and silc_client_channel_message.

Sat Mar 10 21:36:22 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added SKE's key verify callback to the client library's
	  KE protocol context. Affected files lib/silcclient/protocol.[ch].

	* Removed the statement that server (or router) must send USERS
	  command reply when joining to the channel so that the client
	  knows who are on the channel.  Instead, the client list and 
	  client's mode list is now sent in the JOIN command reply to the
	  client who joined channel.  This is better solution.

	* Added function silc_server_get_users_on_channel and function
	  silc_server_save_users_on_channel to the silcd/server.[ch].

	* Removed function silc_server_command_send_users from the
	  silcd/command.c.

	* Do not show topic on the client library anymore.  The topic is
	  sent in the command reply notify to the application and the
	  application must show the topic now.

Sat Mar 10 00:07:37 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added client searching by nickname hash into the IDENTIFY and
	  WHOIS commands in the server as they were clearly missing from
	  them.  Affected file is silcd/command.c.

	* Fixed a bug in private message receiving in the client library.
	  The remote ID was freed and it wasn't supposed, now it is
	  duplicated.

Fri Mar  9 12:40:42 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Minor fix to the channel payload; allocate the data area, as it
	  needs to be of specific length.

	* If the key agreement port is zero then the operating
	  system will define the bound port.  Affected files are
	  lib/silcclient/silcapi.h and lib/silcclient/client_keyagr.c.

	* Added new function silc_channel_payload_decrypt into the file
	  lib/silccore/silcchannel.[ch].

	* Moved the channel message etc, check from silc_packet_decrypt
	  to applications.  The library calls now a generic 
	  SilcPacketCheckDecrypt callback which is to return TRUE or FALSE
	  when the packet is either normal or special.  This was done to
	  allow more wide range of checking that was not allowed when
	  the code was in library.  Now applications can do virtually any
	  checks to the packet and return to the library the decision how
	  the packet should be processed.  Affected files are
	  lib/silccore/silcpacket.[ch].

	  Added silc_server_packet_decrypt_check to the server and
	  silc_client_packet_decrypt_check to the client library.

	* Added silc_server_packet_send_srcdest into silcd/packet_send.[ch]
	  to send with specified source and destination information.

	* Channel message delivery between routers was broken after the
	  channel key distribution was fixed earlier.  The channel key
	  was used be to distributed to other routers as well which is not
	  allowed by the protocol.  Now this is fixed and channel keys
	  really are cell specific and the channel message delivery between
	  routers comply with the protocol specification.

	* Fixed various commands in server to check also the global list
	  for the channel entry and not just the local list.  The affected
	  file silcd/command.c.

Thu Mar  8 21:39:03 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added assert()s to buffer formatting and unformatting routines
	  to assert (if --enable-debug) when error occurs.  Affected
	  file: lib/silcutil/silcbuffmt.c.

	* Changed to auto-reconnect to check whether the remote host is
	  router and register the re-connect timeout if it is.  It used 
	  to check that whether we are normal server, but router must do
	  auto-reconnect with another router as well.  Affected file
	  silcd/server.c.

	* Removed the [<key len>] option from CMODE command as the cipher
	  name decides the key length, nowadays.  See the defined ciphers
	  from the protocol specification.

	* Added [<hmac>] option to the CMODE command to define the HMAC
	  for the channel.  Added SILC_CMODE_HMAC channel mode.

	* Added [<hmac>] option for the JOIN command so that user can
	  select which HMAC is used to compute the MACs of the channel
	  messages.

	* Added Hmac field to the Channel Message Payload.  The integrity
	  of plaintext channel messages are now protected by computing
	  MAC of the message and attaching the MAC to the payload.  The
	  MAC is encrypted.  Now, it is clear that this causes some
	  overhead to the size of the packet but rationale for this is that
	  now the receiver can verify whether the channel message decrypted
	  correctly and also when private keys are set for the channel the
	  receiver can decrypt the packet with several keys and check from
	  the MAC which key decrypted the message correctly.

	* Added silc_cipher_encrypt and silc_cipher_decrypt into the
	  lib/silccrypt/silccipher.[ch].

	* Added silc_hash_len to return the digest length into the
	  lib/silcrypt/silchash.[ch].

	* Rewrote parts of Silc Channel Payload interface in the
	  lib/silccore/silcchannel.[ch].  The encode function now also
	  encrypts the packet and parse function decrypts it.

Wed Mar  7 20:58:50 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a minor formatting bug in the SKE's key material processing.
	  It actually might have processed the keys wrong way resulting
	  into wrong keys.

	* Redefined the mandatory HMAC algorithms and added new algorithms.
	  Added hmac-sha1-96 and hmac-md5-96 which are normal hmac-sha1
	  and hmac-md5 truncated to 96 bits.  The mandatory is now 
	  hmac-sha1-96.  Rest are optional (including the one that used
	  to be mandatory).  Rationale for this is that the truncated HMAC
	  length is sufficient from security point of view and can actually
	  make the attack against the HMAC harder.  Also, the truncated
	  HMAC causes less overhead to the packets.  See the RFC2104 for
	  more information.

	* Added new [hmac] configuration section.  The SKE used to use
	  the hash names (md5 and sha1) in the SKE proposal as HMCAS which
	  is of course wrong.  The official names that must be proposed in
	  the SKE are the ones defined in the protocol specification
	  (hmac-sha1-96 for example).  The user can configure any hmac
	  using any hash function configured in the [hash] section.  At
	  least, the mandatory must be configured.

	  Rewrote the HMAC interface in lib/silccrypt/silchmac.[ch].

	* Added HMAC list to the SKE proposal list.  It has now both
	  hash algorithm list and HMAC list.  This makes the protocol
	  incompatible with previous versions.  The SKE now seems to work
	  the way it is supposed to work, for the first time actually.

	* Defined plain Hash algorithms to the protocol specification.
	  Added sha1 and md5.

Tue Mar  6 15:36:11 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented support for key agreement packets into the server.
	  Added functions silc_server_key_agreement and
	  silc_server_send_key_agreement.  Other than these functions,
	  server has nothing to do with this packet.

	* Added support for private message key packets into the server.
	  Added functions silc_server_private_message_key and
	  silc_server_send_private_message_key.

	* Updated TODO.

	* Changed the silc_[client|server]_protocol_ke_set_keys to be
	  called in the protocol's final callback instead in the END
	  protocol state.  This makes a little more sense and in the same
	  time in client we can use the same protocol routines for normal
	  key exchange and to key agreement packet handling as well.

	* Added to both client's and server's KE protocol context the
	  SilcSKEKeyMaterial pointer to save the key material.  We will
	  bring the key material to the protocol's final callback by doing
	  this.  The final callback must free the key material.

	* Added SKE's packet_send callback into client's KE protocol
	  context so that the caller can choose what packet sending function
	  is used.  This way we can use different packet sending when
	  doing normal SKE when doing key agreement packet handling (in
	  the key agreement packet handling we do not want to encrypt
	  the packets).

	* Implemented the responder side of the key agreement routines
	  in the client.  The client can now bind to specified port and
	  accept incoming key negotiation.  The key material is passed
	  to the application after the protocol is over.

	* Implemented the processing of incoming Key Agreement packet
	  in the client.  Added function silc_client_key_agreement to
	  process the packet.

	* Implemented the intiator side of the key agreement routines
	  in the client.  The client can now initiate key agreement with
	  another remote client.  The key material is passed to the
	  application after the protocol is over.

	* Created client_keyagr.c to include all the key agreement 
	  routines.

	* Added macro SILC_TASK_CALLBACK_GLOBAL which is equal to the
	  SILC_TASK_CALLBACK except that it is not static.

	* Created client_notify.c and moved the Notify packet handling
	  from the client.[ch] into that file.

	* Created client_prvmsg.c and moved all private message and
	  private message key routines from the client.[ch] into that file.

	* Create client_channel.c and moved all channel message and
	  channel private key routines from the client.[ch] into that file.

	* Changed silc_client_get_client_by_id_resolve to resolve with
	  WHOIS command instead of IDENTIFY command, in the file
	  lib/silclient/idlist.c.

Mon Mar  5 18:39:49 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented the SKE's responder side to the Client library.

	* When FAILURE is received to the protocol do not trust it
	  blindly.  Register a timeout to wait whether the remote closes
	  the connection as it should do it, only after that process the
	  actual failure.  This was changed to both client and server.

	* Added client_internal.h to include some of the structures
	  there instead of client.h in lib/silcclient/.

	* Added function silc_task_unregister_by_callback to unregister
	  timeouts by the callback function.

Sat Mar  3 19:15:43 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Some "Incomplete WHOIS info" errors has been appearing on the
	  log files.  Took away the entry->userinfo check from WHOIS
	  reply sending.  The entry->userinfo is now " " if client did not
	  provide one.  I thought this was fixed earlier but something
	  is wrong still.  Let's see if the error still appears.

Wed Feb 28 20:56:29 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a minor bug in the login when the channel key is
	  re-generated in the server.  It used to generate the key in
	  wrong order and thus caused problems in the channel traffic.

	* Fixed a minor bug in channel key distsribution after
	  KICK command.  The key was not sent to the router even though
	  it should've been.

Tue Feb 27 20:24:25 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_ske_process_key_material_data as generic routine
	  to process any key material as the SILC protocol dictates.  The
	  function is used by the actual SKE library but can be used by
	  applications as well.  This relates to the private message keys
	  and the channel private keys since they must be processed the
	  same way the normal SILC session keys.  The protocol dictates
	  this.  Affected files: lib/silcske/silcske.[ch].

	  Added also silc_ske_free_key_material to free the
	  SilcSKEKeyMaterial structure.

	* Defined silc_cipher_set_key function to set the key for
	  cipher without using the object's method function.  The affected
	  files: lib/silccrypt/silccipher.[ch].

	* Implemented silc silc_client_add_private_message_key,
	  silc_client_add_private_message_key_ske, 
	  silc_client_del_private_message_key,
	  silc_client_list_private_message_keys and
	  silc_client_free_private_message_keys functions in the
	  client library.

	  Added functions silc_client_send_private_message_key to send
	  the Private Message Key payload and silc_client_private_message_key
	  to handle incoming Private Message Key payload.

	* Added Cipher field to the Private Message Key payload to set
	  the cipher to be used.  If ignored, the default cipher defined
	  in the SILC protocol (aes-256-cbc) is used.

Tue Feb 27 13:30:52 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Removed lib/silcclient/ops.h file.

	  Redefined parts of the SILC Client Library API. Created new
	  file silcapi.h that deprecates the ops.h file and defines the
	  published Client Library API.  Defined also private message key
	  API and channel private key API into the file.

	  This is the file that the application must include from the
	  SILC Client Library.  Other files need not be included by
	  the application anymore.

	* Added new key_agreement client operation callback and also
	  defined the Key Agreement library API for the application.

Tue Feb 27 11:28:31 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new packet type: SILC_PACKET_KEY_AGREEMENT.  This packet
          is used by clients to request key negotiation  between another
          client in the SILC network.  If the negotiation is started it
          is performed using the SKE protocol.  The result of the
          negotiation, the secret key material, can be used for example
          as private message key.

	  Implemented the Key Agreement payload into the files
	  lib/silccore/silauth.[ch].

Mon Feb 26 12:13:58 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Redefined ciphers for the SILC protocol.  Added some new ciphers
	  and defined the key lengths for the algorithms.  Changed the
	  code accordingly.  The default key length is now 256 bits.

	* Fixed SKE key distribution function silc_ske_process_key_material
	  when the key length is more than 128 bits.  The default key 
	  length in SILC is now 256 bits.

	* Added new command status type: SILC_STATUS_ERR_UNKOWN_ALGORITHM
	  to indicate unsupported algorithm.

	* Renamed rijndael.c to aes.c and all functions as well.

	* Fixed a long standing channel key setting bug in client library.
	  Weird that it has never surfaced before.

	* Fixed bug in channel deletion.  If the entire channel is removed
	  then it must also delete the references of the channel entry
	  from the client's channel list as the client's channel entry and
	  the channel's client entry share same memory.

Sun Feb 25 20:47:29 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented CONNECT and SHUTDOWN commands in the client.

	* Implemented CLOSE command to the client.

	* Added the function silc_idlist_find_server_by_name into the
	  files silcd/idlist.[ch].

	  Added the function silc_idlist_find_server_by_conn into the
	  files silcd/idlist.[ch].

Sat Feb 24 23:45:49 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* DIE command was renamed to SHUTDOWN.  Updated the both code
	  and protocol specs.

	* Defined SILC_UMODE_NONE, SILC_UMODE_SERVER_OPERATOR and
	  SILC_UMODE_ROUTER_OPERATOR modes into lib/silccore/silcmode.h.

	* Implemented CONNECT, CLOSE and SHUTDOWN commands to the server
	  side.

	* Added function silc_server_create_connection function to create
	  connection to remote router.  My server implementation actually
	  does not allow router to connect to normal server (it expects
	  that normal server always initiates the connection to the router)
	  so the CONNECT command is only good for connecting to another
	  router.

Sat Feb 24 16:03:45 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added SILC_NOTIFY_TYPE_KICKED to indicate that the client
	  or some other client was kicked from the channel.

	  Implemented the handling of the notify type to both client
	  and server.

	  Implemented silc_server_send_notify_kicked to send the KICKED
	  notify.  It is used to send it to the server's primary router.

	* Implemented the KICK command into server and client.

	* Added `query' argument to the silc_idlist_get_client function
	  to indicate whether to query the client from server or not if
	  it was not found.

	* Added new command status type SILC_STATUS_ERR_NO_CHANNEL_FOPRIV
	  to indicate that the client is not channel founder.

	* Updated TODO.

Sat Feb 24 00:00:55 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Removed the rng context from SilcPacketContext structure and
	  changed that the packet routine uses the Global RNG API.

Fri Feb 23 11:22:57 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added support for quit message that client can "leave" on the
	  channel when it quits the SILC.  It is ditributed inside the
	  SILC_NOTIFY_TYPE_SIGNOFF notify type.

	  Added silc_server_free_client_data that will take the
	  signoff message as argument.

	* Changed SKE routines to use the silc_pkcs_sign/verify routines.

Thu Feb 22 23:05:36 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Updated parts of the protocol specification to keep it up
	  to date.

Thu Feb 22 15:08:20 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added List flag (SILC_PACKET_FLAG_LIST) to indicate list of
	  payloads in one packet.

	* Deprecated following packet types: NEW_ID_LIST, NEW_CHANNEL_LIST,
	  NEW_CHANNEL_USER_LIST, SET_MODE and SET_MODE_LIST.  List packets
	  use now the new List flag.

	* Also deprecated the following packet types: REPLACE_ID,
	  NEW_CHANNEL_USER and REMOVE_CHANNEL_USER packet types.
	 
	* Added list support for Notify packet in server.

	* Added silc_server_send_notify_channel_change to send the
	  CHANNEL_CHANGE notify type to replace channel ID's.  Deprecates
	  the silc_server_send_replace_id.

	* Added silc_server_send_notify_nick_change to send the
	  NICK_CHANGE notify type.  Deprecates the function
	  silc_server_send_replace_id.

	* Added silc_server_send_notify_join to send the JOIN notify type.
	  Deprecates the function silc_server_send_new_channel_user.

	* Added silc_server_send_notify_leave to send LEAVE notify type.
	  Deprecates the function silc_server_send_remove_channel_user.

	* Added silc_server_send_notify_cmode and 
	  silc_server_send_notify_cumode to send CMODE and CUMODE notify
	  types.  Deprecates the silc_server_send_set_mode function.

	* Added SERVER_SIGNOFF notify type to indicate that server has
	  quit.  This means that all clients on the channel from that 
	  server will drop.  This can be also used when netsplit happens.

	  Deprecated REMOVE_ID packet type since it is not needed anymore
	  even from server.

	  Added silc_server_send_notify_server_signoff to send the
	  SERVER_SIGNOFF notify type.  Deprecates the function
	  silc_server_send_remove_id.

	  Added also silc_server_send_notify_signoff to send the
	  SIGNOFF notify type.

	* Employed the PKCS #1. It is the mandatory way to do RSA in the
	  SILC protocol from this day on.  Changed the protocol 
	  specification as well.

	* Added silc_server_send_notify_topic_set to send TOPIC_SET
	  notify type.  It is used between routers to notify about
	  topic changes on a channel.

	* Added silc_id_dup into lib/silccore/id.[ch] to duplicate
	  ID data.

	* Partly updated the protocol specification to comply with the
	  changes now made.  It is still though a bit outdated.

	* The JOIN notify type now takes one extra argument <Channel ID>.
	  The packet used to be destined to the channel but now the
	  JOIN type may be sent as list thus it is impossible to 
	  destine it to any specific channel.  By adding this argument
	  it is again possible.

Wed Feb 21 22:39:30 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added CREDITS file.  The CHANGES and CREDITS file will appear
	  in the distribution as well.

Wed Feb 21 14:17:04 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented CMODE_CHANGE, CUMODE_CHANGE and TOPIC_SET notify
	  types in the server's silcd/packet_receive.c.

	* Implemented CMODE and CUMODE to work in router environment.

	* Fixed minor encoding and decoding buglet from the
	  lib/silccore/silcmode.c.

	* Fixed buffer overflow from lib/silcclient/command.c in USERS
	  command parsing.

Wed Feb 21 12:44:00 EET 2001  Mika Bostrm <bostik@lut.fi>

 	* Changed all SilcConfigServer* and silc_config_server* to
	  SilcServerConfig* and silc_server_config*, respectively.
	  Patch by Bostik.

Wed Feb 21 00:10:00 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Associated the ID (client or server ID) to the Authentication
	  Payload to avoid any possibility of forging.  Updated the
	  protocol specification and the code accordingly.

Tue Feb 20 14:14:14 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* The RSA key length is now save to the RsaKey context in the
	  key generation process in lib/silccrypt/rsa.c.  The key length
	  is now used to figure out the maximum size of the block allowed
	  to be encrypted/signed.

	* Added silc_mp_mp2bin_noalloc into lib/silcmath/mpbin.[ch].  It
	  is equivalent to the silc_mp_mp2bin but does not allocate any
	  memory.

	* Changed silc_mp_mp2bin API to take length argument.  If it is
	  non-zero then the buffer is allocated that large.  If zero, then
	  the size is approximated using silc_mp_sizeinbase, which however
	  is not relieable.

	* Created Global RNG API which is global RNG that application can
	  initialize.  After initializing, any routine anywhere in the
	  code (including library) can use RNG without allocating a new
	  RNG object.  This was done to allow this sort of use of the 
	  RNG in code that has no chance to allocate RNG object.  All
	  applications currently allocate this and many routines in the
	  library use this.  Affected file lib/silccrypt/silcrng.[ch].

	* Removed the RNG kludge from lib/silcmath/primegen.c and changed
	  it to use the Global RNG API.

	* Defined Authentication Payload into protocol specification that
	  is used during SILC session to authenticate entities.  It is
	  used for example by client to authenticate itself to the server
	  to obtain server operator privileges.

	  Implemented this payload into the lib/silccore/silcauth.[ch].
	  Implemented also routines for public key based authentication
	  as the new protocol specification dictates.

	  Moved definitions of different authentication methods from
	  lib/silccore/silcprotocol.h into lib/silccore/silcauth.h.

	* Added silc_pkcs_encrypt, silc_pkcs_decrypt, silc_pkcs_sign,
	  silc_pkcs_verify and silc_pkcs_sign_with_hash and
	  silc_pkcs_verify_with_hash functions into the file 
	  lib/silccrypt/silcpkcs.[ch].

Mon Feb 19 19:59:28 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* The client entry's userinfo pointer must be always valid. 
	  Otherwise the [<unknown>] bug will surface beacuse the WHOIS
	  will fail since it requires the userinfo.  Now, the userinfo
	  is allocated as "" if actual userinfo does not exist.  Actually,
	  it must exist and it is totally Ok to drop client connections
	  that does not announce the userinfo.  However, we will make
	  this workaround for now.

	* Added silc_net_get_remote_port into lib/silcutil/silcnet.[ch]
	  to return the remote port by socket.

Mon Feb 19 14:26:49 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed SILC_SERVER_COMMAND_EXEC_PENDING macro to the name
	  SILC_SERVER_PENDING_EXEC and added an new macro
	  SILC_SERVER_PENDING_DESTRUCTOR which is called to free the
	  data or when error occurs while processing the pending command.

	  Added new argument `destructor' into silc_server_command_pending
	  and to the SilcServerCommandPending object.  This destructor is
	  now called after calling the pending callback or if error occurs
	  immediately.  If error occurs the actual pending callback won't
	  be called at all - only the destructor.  The destructor may be
	  NULL if destructor is not needed.

	  All this applies for client library code as well.  Similar
	  changes were made there as well for the pending commands.

	  In the client, the application must now allocate the 
	  SilcClientCommandContext with the silc_client_command_alloc
	  function.

	* Added reference counter to the SilcServerCommandContext.  Added
	  function silc_server_command_alloc and silc_server_command_dup 
	  functions.

	  Same type of functions added to the client library for the same
	  purpose as well.

	* Removed the cmd_ident from IDListData away since it is now 
	  global for all connections.  It is the command identifier used
	  in command sending and with pending commands.  The affected file
	  is silcd/idlist.h.

	* Added reference counter to the SilcSocketConnection objecet to
	  indicate the usage count of the object.  The object won't be
	  freed untill the reference counter hits zero.  Currently only
	  server uses this, and client ignores it.  The client must be
	  set to use this too later.  The affected files are
	  lib/silccore/silcsockconn.[ch].  Added also the function
	  silc_socket_dup to increase the reference counter.

	  This was mainly added because it is possible that the socket
	  is removed underneath of pending command or other async
	  operation.  Now it won't be free'd and proper DISCONNECTING
	  flags, etc. can be set to avoid sending data to connection that
	  is not valid anymore.

	* Added SILC_SET_DISCONNECTING to server.c when EOF is read from
	  the connection.  After that it sets SILC_SET_DISCONNECTED.
	  It is, however, possible that the socket data is not still freed.
	  The silc_server_packet_process now checks that data is not
	  read or written to connection that is DISCONNECTED.  The socket
	  get's freed when the reference counter hits zero.

Mon Feb 19 00:50:57 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed the client operation API: channel_message operation's
	  `sender' is now the client entry of the sender, not the nickname
	  and the `channel' is the channel entry, not the channel name.

	  In the private_message operation the `sender' is now also the
	  client entry of the sender not the nickname.

	  Affected file is lib/silcclient/ops.h and all applications
	  using the client operations.

Sat Feb 17 22:11:50 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Moved the calling of ops->connect() from connect_to_server_final
	  into receive_new_id functin since that is the point when the
	  client is actually allowed to send traffic to network.  The
	  affected file is lib/silcclient/client.c.

Sat Feb 17 13:15:35 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* When receiving NEW_CHANNEL_LIST, NEW_CHANNEL_USER_LIST,
	  NEW_ID_LIST and SET_MODE_LIST packets, broadcast the list packet
	  (if needs broadcasting) instead of broadcasting the packets one
	  by one which would make a burst in the network traffic.

	* Added `broadcast' argument to the functions in silcd/server.[ch]
	  silc_server_create_new_channel[_with_id] to indicate whether
	  to send New Channel packet to primary router.

Sat Feb 17 01:06:44 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new function into the silcd/server.[ch] files:
	  silc_server_create_new_channel_with_id to create new channel with
	  already existing Channel ID.

	* Added new packet type SILC_PACKET_SET_MODE_LIST into the file
	  lib/silccore/silcpacket.h.  This packet is used t send list of
	  Set Mode payloads inside one packet.  Server uses this to set
	  the modes for the channels and clients on those channels, that it
	  announced to the router when it connected to it.  The protocol
	  specification has been updated accordingly.

	* The silc_server_new_channel did not handle the packet coming
	  from normal server as it normally does not send that.  However,
	  when it announces its channels it does send it.  Implemented
	  the support for that.

	* Added SILC_ID_CHANNEL_COMPARE macro to compare to Channel ID's
	  into the file lib/silccore/id.h.

Fri Feb 16 23:57:29 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed memory leaks in the functions silc_idlist_del_client,
	  silc_idlist_del_channel and silc_idlist_del_server in the file
	  silcd/idlist.c.  All of those leaked like a sieve.

	* Fixed some small memory leaks in the client's function
	  silc_client_notify_by_server.

	* Added functions into silcd/server.c: silc_server_announce_clients,
	  silc_server_announce_channels and silc_server_announce_server.
	  These functions are used by normal and router server to announce
	  to its primary router about clients, channels and servers (when
	  router) that we own.  This is done after we've connected to the
	  router.

	  These functions effectively implements the following packet types:
	  SILC_PACKET_NEW_CHANNEL_LIST, SILC_PACKET_NEW_CHANNEL_USER_LIST
	  and SILC_PACKET_NEW_ID_LIST.

	* Added new functions into the silcd/packet_receive.[ch]:
	  silc_server_new_id_list, silc_server_new_channel_list and
	  silc_server_new_channel_user_list to handle the incoming 
	  NEW_ID_LIST, NEW_CHANNEL_LIST and NEW_CHANNEL_USER_LIST packets.

	* Added support of changing Channel ID in the function
	  silc_server_replace_id.  If the server that announces a channel
	  to the router already exists in the router (with same name but
	  with different Channel ID), router is responsible to send
	  Replace ID packet to the server and force the server to change
	  the Channel ID to the one router has.

	* Added new notify type SILC_NOTIFY_TYPE_CHANNEL_CHANGE to notify
	  client that the Channel ID has been changed by the router.  The
	  normal server sends this to the client.  Client must start using
	  the new Channel ID as the channel's ID.

	  Implemented handling of this new type into lib/silcclient/client.c
	  into the function silc_client_notify_by_server.

	* Added new function silc_idlist_replace_channel_id into the files
	  silcd/idlist.[ch] to replace the Channel ID.

Fri Feb 16 14:14:00 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Call silc_server_command_identify_check always when processing
	  the IDENTIFY command in silcd/command.c

Thu Feb 15 20:07:37 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new packet type SILC_PACKET_HEARTBEAT that is used to
	  send keepalive packets.  The packet can be sent by clients, 
	  servers and routers.

	  Added function silc_socket_set_heartbeat into the file
	  lib/silccore/silcsockconn.[ch] to set the heartbeat timeout.
	  If not set, the heartbeat is not performed.  The actual 
	  heartbeat is implemented in the low level socket connection
	  library.  However, application is responsible of actually
	  sending the packet.

	  Added silc_server_send_heartbeat to send the actual heartbeat
	  packet into silcd/packet_send.[ch].  Server now performs
	  keepalive with all connections.

	* Added silc_task_get_first function into lib/silcutil/silctask.c
	  to return the timeout task with shortest timeout.  There was a bug
	  in task unregistration that caused problems.  TODO has been
	  updated to include that task system must be rewritten.

	* The client library will now resolve the client information when
	  receiving JOIN notify from server for client that we know but
	  have incomplete information.

	* Rewrote parts of silc_server_remove_from_channels and
	  silc_server_remove_from_one_channel as they did not remove the
	  channel in some circumstances even though they should've.

	* Encryption problem encountered in server:

	  The LEAVE command used to send the Channel Key packet to the
	  router immediately after generating it.  However, the code
	  had earlier sent Remove Channel user packet but not immediately,
	  ie. it was put to queue.  The order of packets in the router
	  was that Channel Key packet was first and Remove Channel User
	  packet was second, even though they were encrypted in the
	  reverse order.  For this reason, MAC check failed.  Now, this
	  is fixed by not sending the Channel Key packet immediately but
	  putting it to queue.  However, this is more fundamental problem:
	  packets that are in queue should actually not be encrypted 
	  because packets that are sent immediately gets encrypted
	  actually with wrong IV (and thus MAC check fails).  So, packets
	  that are in queue should be encrypted when they are sent to
	  the wire and not when they put to the queue.

	  However, the problem is that the current system has not been
	  designed to work that way.  Instead, the packet is encrypted
	  as soon as possible and left to the queue.  The queue is then
	  just purged into wire.  There won't be any fixes for this
	  any time soon.  So, the current semantic for packet sending
	  is as follows:

	  o If you send packet to remote host and do not force the send
	  (the packet will be in queue) then all subsequent packets to the
	  same remote host must also be put to the queue.  Only after the
	  queue has been purged is it safe again to force the packet
	  send immediately.

	  o If you send all packets immediately then it safe to send
	  any of subsequent packets through the queue, however, after
	  the first packet is put to queue then any subsequent packets
	  must also be put to the queue.

	  Follow these rules and everything works fine.

Thu Feb 15 14:24:32 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new function silc_server_remove_clients_by_server to
	  remove all client entries from ID list when the server connection
	  is lost.  In this case it is also important to invalidate all
	  client entires as they hold the invalid server entry.  This
	  fixes fatal bug when server has lost connection and will reconnect
	  again.

Wed Feb 14 16:03:25 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Made some sanity checks to silc_server_daemonise like to check
	  whether the requested user and group actually exists.

	* Added sanity check to SKE's silc_ske_responder_finish to check
	  that the public and private key actually is valid. 

	* Invalidate the client's nickname when receiving Replace ID
	  packet and the Client ID is being replaced.  This means that the
	  server will query the nickname if someone needs it (client)
	  a bit later.

	* Sort the ID Cache in client library when the ID Cache data
	  has changed (needs sorting).

	* Do not allow for SILC client to create several connections to
	  several servers.  The client does not support windows right now
	  and generating multiple connections causes weird behaviour.

	  Irssi-silc client does support windows and can handle several
	  connections without problems, see: www.irssi.org and SILC plugin.

	* Fixed some places where client was added to the IDList.  The
	  rule of thumb is following (in order to get everything right):
	  If the client is directly connected local client then the 
	  `connection' argument must be set and `router' argument must be 
	  NULL to silc_idlist_add_client function.  If the client is not
	  directly connected client then the `router' argument must
	  bet set and the `connection' argument must be NULL to the
	  silc_idlist_add_client function.

	* The funtion silc_server_packet_send_local_channel actually did
	  not check whether the client was locally connected or not.  It
	  does that now.  Fixed a bug related to LEAVE command.

	* Fixed Remove Channel User payload parsing bug in server's
	  silcd/packet_receive.c.  Fixed a bug related to LEAVE command.

	* The server's silc_server_save_channel_key now checks also the
	  global ID list for the channel as it might not be in the local
	  list.  Fixed a bug related to LEAVE command.

	* Is this the end of the [<unknown>] buglet that has been lurking
	  around for a long time?  A little for loop fix in server's
	  silc_server_command_whois_parse that is used by both IDENTIFY
	  and WHOIS command.  At least, this was a clear bug and a cause
	  of one type of [<unknown>] buglet.

	* WHOIS and IDENTIFY commands call the function
	  silc_server_command_[whois/identify]_check function even if
	  we are not router server.

Tue Feb 13 19:55:59 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added --with-gmp configuration option.  If set the GMP
	  is always compiled in the SILC source tree.  If not set then
	  it is checked whether the system has the GMP3 installed.  If
	  it has then the GMP won't be compiled (the system's headers
	  and library is used), if it doesn't have it then the GMP is
	  compiled in the SILC source tree.

Mon Feb 12 11:20:32 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed RSA private exponent generation to what PKCS #1
	  suggests.  We try to find the smallest possible d by doing
	  modinv(e, lcm(phi)) instead of modinv(e, phi).  Note: this is
	  not security fix but optimization.

Sun Feb 11 18:19:51 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new config entry [Identity] to fork the server and run
	  it as specific user and group.  A patch from Bostik.

	* Imported Dotconf configuration library into lib/dotconf.
	  This will be used to create the SILC configuration files later.
	  It will appear in the distsribution after this commit.

Sat Feb 10 21:13:45 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* A big code auditing weekend happening.  Auditing code for 
	  obvious mistakes, bugs and errors.  Also, removing any code
	  that is obsolete.

	  Removed files for being obsolete:

	  o lib/silcutil/silcbuffer.c (the buffer interface is entirely in
	  inline in the file lib/silcutil/silcbuffer.h)

	  o lib/silcutil/silcbufutil.c (the header has inline versions)

	  Changed code to fix possible error conditions:

	  o The buffer formatting routines now check that the destination
	  buffer really has enough space to add the data.  This applies for
	  both buffer formatting and unformatting 
	  (lib/silcutil/silcbuffmt.[ch]).  Also, the entire buffer
	  unformatting was changed to accomodate following rules: 
	  XXX_*STRING_ALLOC will allocate space for the data into the pointer
	  sent to the function while XXX_*STRING will not allocate or copy 
	  the data into the buffer.  Instead it sets the pointer from the
	  buffer into the pointer sent as argument (XXX_*STRING used to
	  require that the pointer must be allocated already).  This change
	  makes this whole thing a bit more consistent and more optimized
	  (note that the data returned in the unformatting with XXX_*STRING
	  must not be freed now).  The routines return now -1 on error.

	  o Tried to find all code that use buffer_format and buffer_unformat
	  and added return value checking to prevent formatting and
	  especially unformatting errors and possible subsequent fatal
	  errors.

	  o Changed ske->x and ske->KEY to mallocated pointers in
	  lib/silcske/silcske.h.  Fixed possible data and memory leak.

	  o Added return value checking to all *_parse* functions.  Fixed
	  many memory leaks as well.

	  o Added length argument to silc_id_str2id in lib/silccore/id.[ch]
	  so that buffer overflows would not happen.  All code now also
	  checks the return value as it can fail.

Mon Feb  5 20:08:30 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added reconnection support to server if the normal server looses
	  its connection to the router (for example if router is rebooted).
	  The server performs normal reconnection strategy implemented
	  to the server.  Affected file silcd/server.c.

Sun Feb  4 13:18:32 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new packet type SILC_PACKET_SET_MODE that is used to
	  distribute the information about changed modes (for clients,
	  channels and clients channel modes) to all routers in the
	  network.  Updated the protocol specification accordingly.

	  Added functions into silcd/packet_send.c and 
	  silcd/packet_receive.c: silc_server_send_set_mode, 
	  silc_server_set_mode.

	  Added new files silcmode.[ch] into lib/silccore that implements
	  the encoding and decoding of Set Mode Payload.  Added new type
	  SilcSetModePayload.  Moved the definitions of different modes
	  from lib/silccore/silcchannel.h into lib/silccore/silcmode.h.

Sat Feb  3 15:44:54 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Oops, a little mistake in server's connection authentication 
	  protocol.  The protocol is not ended with FAILURE but with
	  SUCCESS if the authentication is Ok. :)  Affected file is
	  silcd/protocol.c.

	* Implemented NICK_CHANGE notify handling in server in the file
	  silcd/packet_receive.c  The NICK_CHANGE notify is distributed to
	  the local clients on the channel.  After the changing nickname
	  in router environment snhould work and the [<unknown>] nickname
	  should appear no more.
 
	  The silc_server_replace_id function that receives the Replace ID
	  payload now sends the NICK_CHANGE notify type also in the file
	  silcd/packet_receive.c

	* Changed WHOIS and IDENTIFY command to support the maximum amount
	  of arguments defined in protocol specs (3328 arguments).  This 
	  fixed a bug that caused problems when there were more than three
	  users on a channel.

Fri Feb  2 11:42:56 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added extra parameter, command identifier, to the
	  silc_client_send_command so that explicit command identifier
	  can be defined.

	  Changed that ID list routines uses specific command identifier
	  when sending WHOIS/IDENTIFY requests to the server so that they
	  can be identified when the reply comes back.

	  Affected files lib/silcclient/command.[ch],
	  lib/silcclient/client.c and lib/silcclient/idlist.[ch].

	* Added `sender' argument to silc_server_packet_send_to_channel
	  to indicaet the sender who originally sent the packet to us
	  that we are now re-sending.  Ignored if NULL.  Affected file
	  silcd/packet_send.[ch].

	* Added some server statistics support in silcd/server_internal.h
	  SilcServerStatistics structure and around the server code.  Also
	  send some nice statistics information when client is connecting
	  to the client.

Thu Feb  1 23:31:21 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed channel ID decoding in server's JOIN command reply in
	  silcd/command_reply.c

	* Fixed braodcasting of replace ID payload to not to send it if
	  we are standalone server in silcd/packet_receive.c.

	* Fixed all channel message sending routines to not to send
	  packets to clients that has router set, since they are routed
	  separately in the same function earlier.  Affects file
	  silcd/packet_send.c and all channel packet sending functions.

        * In USERS reply, res_argv[i] are not allocated, the table
          is allocated.  Thus changed that free the table, not its
          internals.

	* In server's whois_check and identify_check if the client is
	  locally connected do not send any WHOIS commands - they are not
	  needed.

Thu Feb  1 21:32:27 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed some minor bugs in client when sending WHOIS command.  The
	  arguments was in wrong order.

	* Removed statis function add_to_channel from server in 
	  silcd/command.c that was previously used with the joining but
	  is obsolete now.

	* Tested USERS command in router environment successfully with two
	  routers, two servers and two clients.

Thu Feb  1 00:54:26 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Reorganized the USERS command and command reply in client library
	  in lib/silcclient/command.c and lib/silcclient/command_reply.c.
	  When the command is given by user we register a pending command
	  callback that will reprocess the command after the reply has been
	  received from the server.  When reprocessing the packet we then
	  display the information.  Thus, the USERS information is displayed
	  now in the command callback instead of in the command reply
	  callback.  The processing of the command is same as previously
	  when server has sent the command reply in the JOINing process.

	* Added to USERS command in silcd/command_reply.c to join the client,
	  we didn't use to know about, to the channel after we've created
	  a client entry for it.  Also, for clienet we did know already still
	  check whether it is on the channel or not and add it if not.

	* Removed silc_server_command_join_notify as the function and its
	  use was obsolete.

Tue Jan 30 22:39:15 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed the client's pending command handling to the same as the
	  server's pending command handling.  It is also now possible to
	  execute command reply functions from other command reply
	  function as the function callbacks for commands and command
	  replies are one and same.  The pending commands are not static
	  list anymore, it is mallocated SilcDList in lib/silcclient/client.h
	  in client connection context.  Thus, pending commands are server
	  connection specific as it is convenient.

	  Changed the function silc_client_command_pending and
	  silc_client_command_pending_del and added new function
	  silc_client_command_pending_check.  Removed the 
	  SILC_CLIENT_CMD_REPLY_EXEC, and SILC_CLIENT_PENDING_COMMAND_CHECK
	  macros.

	* Added cmd_ident, current command identifier, to the client
	  connection context in lib/silcclient/client.h to keep track on
	  command identifiers used in command sending.  Client's command reply
	  function handling now supports the mandatory command identifiers.

	* Added SILC_CLIENT_COMMAND_EXEC_PENDING macros to all command reply
	  funtions in client to fully support pending command callbacks.

	* NOTE: the name_list in USERS (old NAMES) command is NOT sent anymore
	  as one of the arguments to the application in the command reply
	  client operation.

	* NOTE: The FORWARDED flag is depracated.  It used to be depracated
	  before first releasing SILC but came back.  Now it is removed again
	  and should come back nomore.  The FORWARDED flag was used only
	  by the JOINing procedure by forwarding the command packet to router.
	  Now, the JOINing procedure has been changed to more generic (due
	  to various router environment issues) and FORWARDED is not needed
	  anymore for anything.  The protocol specification is yet to be
	  updated.

	  Now, removed silc_server_packet_forward from server and the flag
	  SILC_PACKET_FORWARDED from lib/silccore/silcpacket.h.

Tue Jan 30 00:05:05 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Renamed NAMES command to USERS command.  The NAMES was named that
	  due to historical reasons.  Now it is renamed.  Also, rewrote
	  parts of the USERS command.  The nickname list is not sent anymore
	  by the server.  Only Client ID and mode lists are sent in the USERS
	  command.  Changed this also to the protocol specification.

	  The client now resolves the names and stuff after it receives
	  the USERS list from the server when joining to the channel.

	* WHOIS and IDENTIFY commands has been changed to support multiple
	  Client ID's per command.  One can now search for multiple users
	  in the network by sending only one WHOIS or IDENTIFY command.
	  Changed the code and the protocol specifications.

	* Removed silc_server_command_identify_parse and changed that IDENTIFY
	  uses silc_server_command_whois_parse to parse the request. */

	* If normal server, do not parse the WHOIS and IDENTIFY requests
	  before sending it to the router.  Saves some time.

Sun Jan 28 16:19:49 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed JOIN command on client library.  Wrong number of arguments
	  used to crash the client.

	* Added silc_server_channel_has_global function to check whether
	  channel has global users or not.

	* Added silc_server_channel_has_local function to check whether channel
	  has locally connected clients on the channel.

	* The silc_server_remove_from_one_channel now checks whether the
	  channel has global users or not after given client was removed from
	  the channel.  It also checks whether the channel has local clients
	  on the channel anymore.  If it does not have then the channel entry
	  is removed as it is not needed anymore.

	* The silc_server_notify now checks on JOIN notify whether the joining
	  client is one of locally connected or global.  If it is global then
	  the channel has now global users on the channel and that is marked
	  to the channel entry.  Also, it now saves the global client to
	  global list who is joining and JOINs it to the channel.  This is
	  for normal server, that is.

	  Changed silc_server_send_notify_on_channel, 
	  silc_server_packet_relay_to_channel and 
	  silc_server_packet_send_to_channel check if we are normal server
	  and client has router set (ie. global client) do not send the
	  message to that client, as it is already routed to our router.

	* Implemented LEAVE notify type handling in silc_server_notify 
	  function.

	* Tested LEAVE command in router environment successfully.  Tested
	  with two routers, two servers and two clients.

	* Updated TODO.

	* idlist_find_xxx_by_id routines now dumps the ID on the debug mode.

	* Implemented SIGNOFF notify type handling in silc_server_notify
	  function.

	* silc_server_remove_id now removes the client entry from all channels
	  it has joined and thusly sends SIGNOFF notify type.

	* Rewrote the NAMES list generation in server by removing two excess
	  loops.  The lists are created now inside one loop.

Sat Jan 27 22:34:56 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* silc_server_remove_channel_user checks now also global list
	  for channel and client.

	* silc_server_new_channel_user checks now both local and global
	  list for channel and client.  Fixed a bug in client id decoding.
	  Used to decode wrong buffer.

	* silc_server_channel_message checks now both local and global
	  list for channel entry.

	* Tested channel joining (hence JOIN) in router environment
	  successfully.  Tested with two routers, two servers and two
	  clients.

	* Tested channel message sending in router environment successfully.

Thu Jan 11 03:22:57 EET 2001  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_server_save_channel_key into server.[ch] to save the
	  received channel key in Channel Key payload processing. It is
	  also used in JOIN command reply handling.

	  Equivalent function silc_client_save_channel_key added into
	  client.[ch] into client library.

	* Changed JOIN command reply to send information whether the channel
	  was created or not (is existing already) and the channel key 
	  payload.  Changed protocol specs accordingly.

	* Fixed bugs in WHOIS and IDENTIFY command reply sending when
	  the request was sent by ID and not by nickname.  Crashed on
	  NULL dereference.

Sat Dec 23 21:55:07 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a bug in Client library.  IDENTIFY and WHOIS reply functions
	  now correctly save the received data.

	* silc_server_free_sock_user_data now notifies routers in the 
	  network about entities leaving the network.

	  At the same time implemented functions silc_server_remove_id
	  and silc_server_send_remove_id to receive and send REMOVE_ID
	  packets.  The packet is used to notify routers in the network
	  about leaving entities.  The ID removed will become invalid in
	  the network.

	* Added function silc_idlist_del_server into server. Removes and
	  free's server entry from ID list.

	* silc_server_private_message function now checks, if we are router,
	  that the destination ID really is valid ID, naturally.

	* In router when NEW_ID packet is received (for new client) the
	  hash of the Client ID is saved in the ID Cache but the
	  client->nickname is set to NULL, instead of putting the hash
	  to it as well.

	  IDENTIFY command now also checks that client->nickname must be
	  valid. If it is not if will request the data from the server who
	  owns the client.  Added new function 
	  silc_server_command_identify_check.

	* Added silc_command_set_command into lib/silccore/silcommand.[ch]
	  to set the command to already allocated Command Payload.

	* Tested private message sending in router environment with two
	  routers, two servers and two clients.  Fixed minor bugs and now
	  it works fine.

	* Fixed segfault from client's NAMES command. Used to crash if
	  not on any channel.

	* Forwarded packets must not be routed even if it is not destined
	  to the receiver.  Changed server code comply with this.

Sun Dec 17 14:40:08 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added `require_reverse_mapping' boolean value to ServerParams
	  structure. If TRUE (not default) the server will require that
	  the connecting host has fully qualified domain name.

	  If the reverse mapping is not required and hostname could not be
	  found the IP address is used as hostname.

Sat Dec 16 17:39:54 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented version string checking to both client and server.
	  The check is incomplete currently due to the abnormal version 
	  strings used in development version of SILC.

	* Changed all command functions in server to use the new
	  CHECK_ARGS macro.

Fri Dec 15 15:55:12 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed char *data to unsigned char *data in ID Cache system to
	  support binary data as ID Cache data. Changed code to support
	  binary data in lib/silccore/idcache.c.

	* Renamed silc_server_packet_relay_command_reply to 
	  silc_server_command_reply as it is normal packet receiving
	  function. Rewrote the function to accept command replys for
	  servers and not only for clients.

	* Mark remote router always as registered server if we are connecting
	  to it.  Otherwise, commands sent by the router to us are ignored.

	* All ID List find routines now returns the ID Cache Entry pointer
	  as well if requested.

	* WHOIS command works now in router environment, tested with two
	  routers, two servers and two clients.

	* Cleaned up and rewrote IDENTIFY command. IDENTIFY should work now
	  in router environment (as it is almost equivalent to WHOIS) but
	  hasn't been tested thoroughly.  Added new functions:

	  silc_server_command_identify_parse
	  silc_server_command_identify_send_reply
	  silc_server_command_identify_from_client
	  silc_server_command_identify_from_server

	* Disabled route cache adding because adding two different ID's with
	  same IP replaces the old cache entry thus giving wrong route.
	  The entry->router->connection is always the fastest route anyway
	  so route cache may not be needed.  Of course, new routes maybe
	  established after receiving the ID when the entry->router->connection
	  might not be anymore the most optimal.

Thu Dec 14 15:55:35 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Add route cache for received ID for fast routing.

	* Added silc_server_packet_route to route received packet on router
	  that is not destined to us.

	* Renamed silc_server_get_route to silc_server_route_get.

	* Added id_string and id_string_len fields into SilcServer to
	  include encoded ServerID for fast comparing without excess
	  encoding of the ID's.

	* Cleaned up WHOIS command on server side. Added following static
	  functions:

	  silc_server_command_whois_parse
	  silc_server_command_whois_check
	  silc_server_command_whois_send_reply
	  silc_server_command_whois_from_client
	  silc_server_command_whois_from_server

	* Added macro SILC_SERVER_COMMAND_CHECK_ARGC to check mandatory
	  arguments in command replies. All command functions should be
	  updated to use this macro.

Sun Dec 10 23:52:00 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Minor typo fixes on command reply handling on server.

Tue Nov 28 11:05:39 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_server_command_add_to_channel internal routine to add
	  the client to the channel after router has created the channel and
	  sent command reply to the server.

	* Added generic silc_server_send_command to send any command from
	  server.

	* Use static buffer with ID rendering instead of duplicating data.

Mon Nov 27 21:39:40 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed a channel user mode bug when joining to a channel server gave
	  everybody channel founder rights, oops.

	* We mark ourselves as the router of the incoming server connection
	  if we are router ourselves.  This way we can check in some packet
	  sending functions whether it is locally connected server.  For
	  incoming router connections we put NULL.

	* For router sending packets locally means now always sending the
	  packet cell wide; to local clients and local servers.  For normal
	  server sending packet locally means sending it to only local
	  clients.

	* Fixed the JOIN command to really work in router environment.  If the
	  channel is created it is always created by the router.  Router is
	  also responsible of making the initial joining to the channel,
	  sending JOIN notify to the sending server and distributing 
	  NEW_CHANNEL and NEW_CHANNEL_USER packets.  Hence, if the channel
	  does not exist server doesn't do anything else but forward the
	  command to the router which performs everything.

	* Added silc_server_send_channel_key function to send the Channel Key
	  payload.

	* Added silc_server_create_channel_key to create new channel key.  The
	  channel key is now re-generated everytime someone joins or leaves
	  a channel, as protocol dictates.  Note: channel->key_len is the
	  key length in bits.

Wed Nov 22 22:14:19 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Splitted server.[ch] finally.  Created now packet_send.[ch] and
	  packet_receive.[ch] to separate packet sending and receiving
	  routines.  The server.[ch] now includes everything else including
	  actual packet processing (writing and reading data) and other
	  server issues.

	  Renamed silc_server_private_message_send_internal to
	  silc_server_send_private_message.  The routine is still though
	  used only to relay private messages as server does not send
	  private messages itself.

	  Renamed silc_server_new_channel to silc_server_create_new_channel
	  and added new function sicl_server_new_channel that handles the
	  incoming New Channel packet.  Added also new sending function
	  silc_server_send_new_channel to send New Channel Payload.

	* Added new function silc_server_notify to process incoming notify
	  packet to the server/router. Server may then relay the notify
	  to clients if needed.

	* Added new function silc_server_new_channel_user to process incoming
	  New Channel User packet.  Router will redistribute the packet and
	  send JOIN notify to its local clients and locally connected servers
	  if needed.  Normal server will send JOIN notify to its local client
	  on same channel when received this packet.  Added also corresponding
	  sending function silc_server_send_new_channel_user to sent the
	  payload.

	* Added boolean route argument to send_notif_to_channel and
	  packet_send_to_channel functions to attempt to route the packet
	  if it is TRUE and send only locally if it is FALSE.

Tue Nov 21 19:49:31 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* silc_server_replace_id now broadcasts the received replace ID
	  packet if it is not broadcast packet already. The router must
	  broadcast to inform other routers about changed ID.

	* Added backpointer to server's router into SilcServer context in
	  silcd/server_internal.h.

	* Fixed silc_server_packet_broadcast to send correct broadcast
	  packets.

	* The channel key is now distributed to the local client as soon
	  as it is received from the router (in router environment) so that
	  no other packet may be sent for the channel until client has 
	  received the key.

	* silc_server_remove_channel_user now broadcasts the received
	  Remove Channel User packet if it is not broadcast packet already.
	  The router must broadcast to inform other routers about removed
	  channel user.

	* Added users field into SilcPacketContext that is a reference count
	  of the context.  One can increase the reference count by calling
	  silc_packet_context_dup which is now changed to just increase the
	  reference count instead of duplicating the data.  The reference
	  count is decresed by calling silc_packet_context_free that will
	  free the data after the reference count hits zero.

	  For now on the packet context and everything allocated into it
	  (including the raw packet from network) must be freed by calling
	  the new silc_packet_context_free function.  Added also new function
	  silc_packet_context_alloc that must be used now to allocate the
	  context.  This also means that if a routine is asynchronous from
	  silc_[client/server]_packet_parse_type the packet context must
	  be duplicated by calling silc_packet_context_dup.  Otherwise it
	  gets free'd after silc_[client/server]_packet_parse_type returns.
	  Also, one must remember that if packet is duplicated then its 
	  reference count must be decresed by calling the free function as
	  many times as it was duplicated.

	* Changed SilcBuffer field from protocol contexts to SilcPacketContext
	  from both client and server.

Mon Nov 20 23:47:03 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Made joining to a channel working in router environment.

	* Cleaned up JOIN command on server side and create function
	  silc_server_command_join_channel internal routine to make the
	  joining happen.

Thu Nov  9 21:12:39 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed silc_command_pending list to SilcDList.  Also, added
	  `ident' field to SilcServerCommandPending structure to identify
	  the reply and to call correct callback.

	  Added silc_server_command_pending_check function to replace the
	  corresnponding macro.  The silc_command_pending list is not
	  extern anymore.

	* Added silc_command_set_ident into lib/silccore/silccommand.[ch]
	  to set identifier to previously allocated Command Payload.  It
	  is used to set identifier for command when resending Command
	  Payload.

	* Added silc_command_payload_encode_payload to encode Command
	  Payload buffer from SilcCommandPayload structure.

	* Added silc_argument_payload_encode_payload to encode Argument
	  payload buffer from SilcArgumentPayload structure.

Wed Nov  8 21:03:28 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed WHOIS command to support router connection on server side.
	  The whois request is always sent to router unless the server is
	  standalone server.  After server has received the reply from the
	  router will it send the reply to the client.

	* Added silc_server_packet_broadcast into silcd/server.[ch] to
	  broadcast received broadcast packet.  The function is used only
	  by router.  The broadcast packet is always sent to the router's
	  primary route.

	* Added silc_id_render function in lib/silcutil/silcutil.[ch] to
	  render given ID to printable string, for log files for example.

Tue Nov  7 22:14:19 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Made basic router to router connections working.  At least they
	  can now connect to each other but nothing really works the way
	  they are supposed - yet.

	* Added new initiator token to RouterConnection configuration
	  file in silcd/serverconfig.[ch].  It is used to tell whether we
	  are the initiator to the remote router or whether we'll expect
	  the other end to connect.

	* Moved registering of listener task to silc_server_init, hence
	  the server starts listenning as soon as it is run, even if it
	  does not have connections to other routers.  Let's see how well
	  this will work.

	* Changed default connection retry timeouts for more suitable in
	  silcd/server.h.

	* Removed cipher and such arguments from silc_idlist_add_client
	  and silc_idlist_add_server prototypes from silcd/idlist.[ch].
	  Added new function silc_idlist_add_data to add the keys and stuff
	  to any ID entry.

	* Added SilcIDListData structure and added it to SilcClientEntry
	  and SilcServerEntry as their first field in the structure.  This
	  way we can explicitly cast the ID entries to the SilcIDListData
	  structure and get common data for the entries.  In past, we had
	  to first check what type of connection it is and then cast it to
	  correct ID entry type.  Now, we can directly cast the opaque
	  pointer to the SilcIDListData (no matter what ID entry it actually
	  is) and get the data needed.

Mon Nov  6 21:56:12 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Wow, found a bug in scheduler.  The scheduler uninitialized itself
	  in some circumstances even if threre were timeout tasks, though not
	  IO tasks, but tasks anyway.  Now fixed.

	* Defined SilcServerConnection structure to hold connection specific
	  stuff about directly connected servers and routers.  The definition
	  is currently in silcd/server_internal.h.  I thought about having
	  a bit more important role fro this struct but for now it is used
	  only when connecting to other server (or router actually).

	* Added connecting retry support in server when connecting to
	  router(s).  The retry feature implement exponential backoff
	  algorithm.  Also, added SilcServerParams structure to hold default
	  parameters for server.  For now, it include these retry settings
	  and are hard coded.  After server is moded to be as Silc Server
	  Library this structure will be more important.

Sun Nov  5 22:28:44 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed client librarys channel->clients table to SilcList and
	  changed code accordingly.

Thu Nov  2 16:28:01 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed client's channel table to SilcList and changed code 
	  accordingly.  Also changed SilcChannelClientEntry to include back-
	  pointer to the channel so that client entry can use that structure
	  as list as well and we have fast cross-reference to the channel.
	  This change dramatically decreased the complexity of channel
	  handling with client entry and vice versa (removed one extra
	  loop when searching for channel entry from many functions).

	* Changed server->sim from table to SilcDList and changed code
	  accordingly.

	* NAMES command can now be used from user interface.  It will show
	  the user list on the channel, neatly.

	* Added realname pointer to SilcClientEntry in lib/silcclient/idlist.h.
	  Code now saves realname of the user if it becomes available.

	* Renamed configure.in to configure.in.pre and made ./prepare
	  script to automatically add correct version string to
	  configure.in which it creates from configure.in.pre.

Wed Nov  1 17:21:26 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* NAMES command reply now shows users mode with the nickname when
	  joining to channel.

	* Moved silc_client_ch[u]mode[_char] functions from 
	  silc/clientutil.[ch] to lib/silcclient/client.[ch].  Though, that
	  place sucks, they are utility functions and should be in some
	  other file.

	* Fixed some unsigned int's to unsigned short's.  Patch by cras.

	* Fixed contrib/getopt*.[ch] to not require config.h.  Patch by
	  cras.

Tue Oct 31 20:10:37 EET 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Updated README.

	* Added TRQ (efficient deque and list library) into lib/trq.  This is
	  a very good list library that is currently used in the SILC.  Defined
	  SilcList API over the library because I didn't like the API very
	  much.  See lib/trq/silclist.h for the API and examples of how to
	  use the API.  Fixed various places in the code to use the new
	  SilcList API. The SilcList is meant for lists that has a structure
	  already defined as a list.  It is not suitable to add just some
	  context to the list (in TRQ, the context is the list actually).

	  So, I defined SilcDList that can be used for the purpose where 
	  predefined list structure does not exit.  This can be used as
	  such list.  Now some context just can be added to the SilcDList.
	  Currently this list is not used in the SILC just yet, though there
	  are a lot places where this can replace dynamically allocated
	  tables and I will fix these places, later, to use SilcDList.
	  See lib/trq/silcdlist.h for SilcDList (they are all inline functions,
	  and use TRQ internally).

	  Also fixed some annoying warning messages that the original TRQ
	  code generated.  Also minor changes to TRQ's Makefile.in.

	* Added support for querying by Client ID to both WHOIS and 
	  IDENTIFY commands into server, as required by the protocol.

	* Removed method function pointers from SilcBuffer structure. They
	  weren't used to anything and just increased the context size for
	  no good reason.  This change also made silc_buffer_alloc and
	  silc_buffer_free functions inline functions.

	* Disabled command flooding detection support until it's fixed so 
	  that it accepts commands in but does not execute them more than once
	  in two seconds.

	* Added silc_net_localhost(), to return local hostname, into
	  lib/silcutil/silcnet.[ch].  Also added client->hostname pointer
	  that must be initialized before calling silc_client_init.

	* Added new function: silc_server_send_notify_on_channels to send
	  notify messages to all channels client has joined.  It is assured
	  that the message is sent only once per client.

	* Moved silc_log_format (from lib/silcutil/silclog.[ch] into
	  lib/silcutil/silcutil.[ch] as silc_format function.  The new 
	  function is generic and is used by server as well, not only by
	  the logging routines.

	* Added new SKE status type: SILC_SKE_STATUS_BAD_VERSION to indicate
	  the provided version string was not acceptable.  Added new function:
	  silc_ske_check_version into lib/silcske/silcske.h.  The function
	  must be implemented by the application (client or server) and it
	  does not reside in the SKE library.  The function checks the version
	  string remote end sent.

	* Added back pointers (to opaque context and to SilcSocketConnection) 
	  into SilcPacketContext structure into lib/silccore/silcpacket.h.

	* Added silc_packet_context_dup into lib/silccore/silcpacket.[ch] to
	  duplicate packet context structure.

	* Changed `notify' client operation to send same arguments as client
	  receives from server except for ID's.  ID's are mapped to correct
	  ID entry and that is returned.  Also, if channel entry is not sent
	  by server but the notify is for channel the channel entry is sent
	  to application (otherwise application doesn't know that it is for
	  channel (library gets it from packet's Destination ID)).

	* Added silc_client_remove_from_channels into client library to 
	  remove a client from all channels it has joined to.  Used when 
	  received SIGNOFF notify from server.  Added also new function
	  silc_client_replace_from_channels to replace old ID entry with
	  new ID entry on all channels.  Used when received NICK_CHANGE
	  notify from server.

	* Fixed ID Cache list handling in silc_idlist_get_client in 
	  lib/silcclient/idlist.c.  Also, added silc_idlist_get_client_by_id
	  to get (or query) client by ID.

	* Updated TODO list.

	* Added connection authentication status message defined by the
	  protocol: SILC_CONN_AUTH_OK and SILC_CONN_AUTH_FAILED and added the
	  support for these into the code in client and server side.

	* Added generic function silc_client_send_command to send any command
	  with variable argument list.  Application should use this function
	  to send commands if the command functions provided by the library
	  does not suite for the application's user interface needs.

	* Added new `failure' client operation.  Application is notified about
	  received failure packet if client is executing a protocol.  In this
	  case the protocol's execution has failed.

	* Added SKE's end notify to send the SKE_SUCCESS notify message that
	  is required by the protocol.

	* Added SILC_PROTOCOL_STATE_FAILURE to indicate received failure
	  packet from remote.  SILC_PROTOCOL_STATE_ERROR indicates local
	  error at our end.

	* Added status flag to SilcSKE object to indicate realtime status
	  of the SKE protocol.

	* Application receives now exactly same command reply arguments as
	  the library receives from server.  However, if ID is received the
	  corresponding ID entry is returned to the application (eg. Client
	  ID is mapped to correct SilcClientEntry entry and that is returned).
	  Changed command_reply client operation due to this change.

	* Changed all ID's in commands and in command replys as ID Payloads.
	  Change affected both client and server side codes.

	  All ID's sent in SILC network (with execption of ID's in SILC
	  Packet header) are sent in ID Payload to support variable length
	  ID's.

	* Server now notifies nick changes and notifies all clients on
	  the channels about the new nickname (about the new Client ID,
	  actually).

	* Implemented CMODE command to change channel modes. Supports all
	  channel modes defined by the protocol specs except ban and invite
	  lists. (Also, private channel key mode is supported but support for
	  setting private channel key in client is missing, thus, this mode
	  has no effect on client side (except that server requires that the
	  client uses private channel key and normal channel traffic does not
	  work anymore)).

	  Also, invite mode works per se, but INVITE command does not work
	  yet correctly, so you can set channel as invite only channel but
	  inviting clients to the channel does not work (it is yet to be
	  thought what's the best way to do it).

	* Added new command SILC_COMMAND_CUMODE to change user mode on the
	  channel.  Defined user modes: CHANNEL_FOUNDER and CHANNEL_OPERATOR.
	  Implemented CUMODE command to change user's mode on the channel.
	  Supports all modes defined by the protocol specs.

	* Added NAMES command reply to return users modes on the channel.

	* Removed unnecessary and slow ciphers from lib/silccrypt.

	* Set SO_KEEPALIVE option to connection sockets by default.

	* Added new command reply status: SILC_STATUS_USER_NOT_ON_CHANNEL.

	* Added notify types: MOTD, CMODE_CHANGE and CUMODE_CHANGE.  Also,
	  redefined the Notify Payload into protocol specs.

	* Added silc_id_payload_parse_id to get ID directly from raw
	  ID payload data.

Mon Oct  9 20:57:02 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Changed SILC_COMMAND_IDENTIFY in protocol specification to 
	  accept searching by Client ID as well.

	* Added support for LEAVE and SIGNOFF notify types in client library.

	* Added silc_id_payload_parse_data into lib/silccore/silcpayload.[ch]
	  to parse ID Payload from raw data.

Sun Oct  8 19:33:08 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added flags parameter into silc_ske_assemble_security_properties
	  function in lib/silcske/silcske.[ch].

	* Changed notify client operation to fit better for notify messages
	  sent by server.  The notify payload received from server is now
	  passed to the application (after parsing it to SilcNotifyPayload).
	  It is application's responsibility to retrieve the arguments
	  from the payload and show the message the way it wants.  The message
	  sent by server is implementation specific.

	* Changed public keys to comply with the protocol specification.
	  Old public keys are not supported anymore and are not compatible.

	* Removed nickname from Channel Payload as the latest draft removed
	  it.  The client must resolve the nickname from the NAMES command
	  reply received when it joined the channel.

	  Also, changed all channel_xxxx_payload to channel_payload_xxxx.

Sat Oct  7 21:55:01 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed some errors in protocol specification drafts.

	* Created lib/silccore/silcnotify.c to implement Notify Payload
	  encoding and decoding, lib/silccore/silcpayload.[ch] to implement
	  generic payloads described by protocol specifications.  The file
	  includes implementations for ID Payload and Argument Payload.

	* Changed Command Payload implementation to use the new Argument
	  Payload.  Changed command_xxxx_payload to command_payload_xxxx
	  to comply with SILC coding conventions.

	* Added suppport for Argument Payload handling in Notify Payload
	  implementation as protocol requires it.  Added the new support
	  into server and client lib as well.

Thu Oct  5 21:16:28 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added support for multiple nicknames on same channel.  [n] is
	  added locally to the nickname if there are more than one same
	  nicknames on the channel.

	* Server now sends all nicknames that matched WHOIS request.
	  Client also shows the list received from server.

	* Added TOPIC command to client side.  User can now set and show
	  current topic on channel.

	* Added MOTD command to client and server.  Also, server sends the
	  motd when client connects to the server.

	* Changed version strings to comply ISO 8601.

Wed Oct  4 23:29:06 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed protocol error handling in client library.  It should now
	  cope even if the SKE fails for some reason.

	* Made new protocol specification drafts for submitting to IETF.

	* Implemented TOPIC command to server in silcd/command.c.

	* Added two new notify types into lib/silccore/silcnotify.h:
	  SILC_NOTIFY_TYPE_NICK_CHANGE and SILC_NOTIFY_TYPE_TOPIC_SET to
	  notify nickname change and topic setting/change on a channel.

	* API change of command_reply operation in client library.  The
	  application gets now the status type received from server as well.

Sat Sep 30 16:57:42 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Removed the function just added to lib/silcutil/silcschedule.[ch].

	* Cras fixed and optimized the packet handling even further and
	  it should work now.  Minor change to the prototype of function
	  silc_packet_receive_process in lib/silccore/silcpacket.[ch].

Sat Sep 30 08:48:47 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added new function into lib/silcutil/silcschedule.[ch]:
	  silc_schedule_with_fd to select() a specified fd.  The function
	  returns after timeout expires or data arrives or goes.  The
	  function is used by packet routines to wait that all data is
	  received from network.

	* Fixed data reading from network in lib/silccore/silcpacket.c.
	  The code now assures that all data is read from the fd and then
	  continues packet processing.  This was a bug fix since the code
	  used to drop some data in some circumstances.

	* Added new function into lib/silcclient/client.[ch]:
	  silc_client_start_key_exchange to start key exchange after
	  connection has been established to server.  The code internally
	  now uses this funtion but its main purpose was to provide it
	  for applications that perform their own connecting.  After
	  application has created a connection it merely calls this
	  function to start the key exchange between client and server.
	  The library takes care of everything else after that.

	  Updated also lib/silcclient/README to explain the usage of
	  this new function.

	* Do not send to application information that connection has
	  been established.  Application gets notified it by connect
	  operation anyway.

Thu Sep 28 23:40:19 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Applied cras's patch to add silc_schedule_one function.  The
	  function runs scheduler once and returns.

	* Fixed the scheduler after cras messed it up.  The timeout
	  handling works now as it's supposed to work.

	* Added into lib/silccore/ silcnotify.h to include notify
	  message types support.  Changed silc_server_send_notify*
	  functions, in server.[ch], to support those new notify types.
	  Added the support for the notify types into client library,
	  as well.  Added new notify client operation into ops.h in
	  lib/silcclient/.

	* Changed silc_server_packet_send_to_channel to send normal
	  packets instead of just channel message packets.  The function
	  is now used to send the notify packets to channels.  It is not
	  used to send channel message packets anymore, as server never
	  sends them anymore.

	* Added explicit casting into lib/silcutil/silcbuffmt.c to few
	  va_arg()s as it seems to require it nowadays.  I guess, if SILC
	  is compiled with older va_arg() the new code should work anyway.

Wed Sep 13 18:10:14 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Splitted core library.  Core library (lib/silccore) includes
	  now only SILC protocol specific core (and common) components.
	  Created new utility library (lib/silcutil) that includes more
	  generic purpose stuff.  The stuff for util library was taken
	  from the old core library.  This was minor and easy split.

	* Created SILC Client Library (lib/silcclient) that includes
	  implementation of the SILC client without user interface.  This
	  was major move from silc/ directory.  The code has been changed
	  so that it is transparent towards the user interface.  The
	  silc/ directory includes now the same user interface as before
	  and it uses the new client library.  Read lib/silcclient/README.
	  Basicly, the client library performs everything else related
	  to SILC except user interface handling.  Also, configuration
	  files are considered to be part of user interface and library
	  does not handle them.

	  This change also changed a lot of structures, function naming etc.
	  Most important change was that SilcClientWindow object was
	  renamed to SilcClientConnection in the client library.  Created
	  also new file lib/silcclient/ops.h.  Also added new files
	  silc/local_command.[ch] and silc/client_ops.[ch].

	  All these changes were made to make it easier for user interface
	  designers to create what ever user interface for the SILC client
	  they want.

	  It is also expected that the server will be moved to lib
	  directory as well and SILC Server Library will be created;
	  sometimes in the future.

	* Removed Local commands from lib/silccore/silccommand.h as
	  they are application specific and new client library does not
	  handle any of those anymore.

	* Several functions moved to lib/silcutil/silcutilc.[ch] from
	  old client implementation in silc/.

	* Added support for callback functions in SILC_LOG_* macros.
	  Application can now set its own callbacks that will be called
	  instead of using the default functions that will always print
	  the debug messages to stderr (or stdout).  Also, debugging can
	  now be disabled by setting silc_debug to FALSE and re-enabled by
	  setting it to TRUE.  Note, that logging will still work even
	  if debugging is disabled.

	  New functions in lib/silcutil/silclog.[ch]: silc_log_set_callbacks,
	  silc_log_reset_callbacks, silc_log_set_debug_callbacks and
	  silc_log_reset_debug_callbacks.

	* To enable debugging in silc client one must give now -d
	  option on command line.

	* Changed silc_schedule_init to automatically allocate task queues
	  if they are not allocated before calling it.

Thu Sep  7 10:49:33 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added GMP 3.1 into math library.

Sun Aug 20 21:27:26 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added SILC_PACKET_REMOVE_CHANNEL_USER to remove a client from
	  a channel in SILC network.  The packet is used by servers and
	  routers to notify other routers that user has left a channel.
	  This little feature was missing until now.  Added the feature
	  to protocol specification as well.

	  Added functions: silc_server_send_remove_channel_user and
	  silc_server_remove_channel_user into server.[ch].

	* Added SILC_PACKET_REKEY and SILC_PACKET_REKEY_DONE into
	  lib/silccore/silcpacket.h.  However, they are not implemented
	  yet.

Sat Aug 19 23:04:16 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed joining to a channel and sending channel messages
	  between server and router.  The channel message sending should
	  now work inside a cell.

Tue Jul 25 20:46:13 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the private message sending between server and router.
	  The private message sending should now work inside a cell.

	* Added silc_server_replace_id into server.[ch] to replace
	  existing ID in the SILC network.

	* Added silc_idlist_find_server_by, silc_idlist_replace_client_id
	  and silc_idlist_replace_server_id into idlist.[ch] in server.

Mon Jul 24 18:33:31 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed the server to server connections.  Server can again now
	  connect to router.  Router to router connections probably does
	  not work just yet.

Thu Jul 20 13:15:01 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added dynamic protocol registering support.  Now protocols can
	  registered and unregistered on the fly.  Patch by cras.

Wed Jul 19 19:08:46 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added lib/contrib directory to hold routines that some platforms
	  don't have but are needed by SILC.

	* Added getopt.c, getopt1.c and getopt.h from GNU C library
	  into lin/contrib to provide getopt() and getopt_long() for
	  those who don't have it.

Tue Jul 18 20:41:20 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added AWAY command to client.  When away message is set and
	  client receives a private message packet the client automatically
	  replies to the sender with the away message.

	* Fixed a bug in lib/silcmath/mpbin.c: silc_mp_mp2bin.  This
	  bug seemed to be the cause of recent problems when compiling
	  with gcc-2.95.

	* Added version detection support to SKE protocol specification
	  and added the new changes to the SKE implementation as well.
	  There were other minor changes in the SKE protocol as well.

	  Many changes in lib/silcske/silcske.[ch] and in
	  lib/silcske/payload.[ch].

	* Added ^U functionality, clear input line.  Patch from cras.

Mon Jul 17 23:33:26 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Mainly small bugfixes on core library.  Fixed some debugging
	  logging and buffer overflow in silclog.c.

	* Updated config.sub and config.guess on the distribution tree.

Sat Jul 15 15:33:48 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added command lagging support in server. Client may execute
	  commands now only once in two seconds.

Thu Jul 13 22:10:21 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Optimized packet reception. MAC computation and checking is now
	  also more optimized.  A lot previously duplicated code is now
	  used as generic by both client and server.

	* Fixed key pair generation in clientutil.c

Wed Jul 12 18:28:07 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added into lib/silccore/silcbufutil.[ch] new function;
	  silc_buffer_realloc.

	* Moved generic packet sending/encryption functions to 
	  lib/silccore/silcpacket.[ch] from client and server.  Some
	  rewriting of the functions.

	* Moved all generic packet reception/decryption functions to
	  lib/silccore/silcpacket.[ch] from client and server.  The
	  packet processing is now much cleaner in both client and server.
	  These were major changes in both client and server.

	* Created many common functions in server to do packet sending.
	  Previously code were duplicated a lot, this has been removed
	  with these changes.

Tue Jul 11 20:27:26 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Rewrote major parts of the ID cache system.  Don't know 
	  whether it is better now or not but at least the API is more
	  cleaner now.

	* Major rewrite on ID cache stuff on client because of the ID
	  cache API changes.  Added idlist.c to client.

	* Also major rewrite on ID cache stuff on server as well.
	  Major rewrite of idlist.[ch]. SilcXXXList's are now named
	  SilcXXXEntry's.  We won't keep anymore idlist specific pointers
	  in hand, instead they are all put into the ID cache system now.
	  All server_idlist_* routines uses ID cache now instead of
	  traversing its own lists (those lists does not exist anymore).
	  SilcIDList though still exists.  Also, SilcXXXEntry's are
	  now pointers.

Sun Jul  9 15:19:24 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Finally made the SKE implementation compliant to the protocol
	  specification.  All mp integers are now binary encoded as
	  opposed being HEX encoded.

	* Added lib/silcmath/mpbin.[ch].  Encoding mp intergers to and
	  from binary data.

	* Added into lib/silccore/silcutil.[ch] PEM encoding/decoding
	  functions: silc_[encode/decode]_pem.  Also added function
	  silc_encode_pem_file to PEM encode with newlines ('\n') for
	  saving into a file.

	* SILC public keys are now encoded either PEM or binary.  Same
	  option is for private keys as well.  By default private keys
	  are binary encoded and public keys PEM encoded.  Silly HEX
	  encoding were removed.

	* Added into lib/silccrypt/silchash.[ch] silc_hash_fingerprint
	  function to create fingerprints.

	* Fixed a bug in SHA1; does not change the original data anymore.

	* Partly implemented INFO command on client and server side.
	  Fixed CLEAR command.  Changes to SERVER command; show current
	  server(s) when giving command without arguments.  Added
	  VERSION command to client.

	* Added check to server that unregistered connections cannot
	  execute commands (unless it is specificly allowed).

Thu Jul  6 18:12:24 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Fixed screen refresh.

	* Fixed channel joining bug from client.  On some circumstances
	  client tried to join to a channel it had already joined.

	* Added public key verification process into client's protocol.c.
	  The client now verifies the public key from user and saves
	  it into ~./silc/serverkeys/ directory. 

	  Added into: clientutil.[ch]: silc_client_verify_server_key.

	* Changed SKE protocol's silc_ske_initiator_finish function
	  to accept callback function that verifies the received public
	  key.  Removed old silc_ske_verify_public_key function.

Wed Jul  5 19:19:02 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added into silcpkcs[ch]: silc_pkcs_public_key[_data]_set and
	  silc_pkcs_private_key[_data]_set.

	* Made the password and public authentication more cleaner in
	  server's protocol.c.

	* Removed historic and obsolete protocol `channel_auth' from
	  both client and server.

	* Removed wrong way of sending command status messages from
	  server to client in server's command.c.  The old way violated
	  protocol specification.  

	  Changes to silccore/silccommand.[ch]: removed
	  silc_command_encode_status_payload -> not needed anymore,
	  changed silc_command_encode_payload_va to accept extra
	  argument on variable argument list.  The argument type must
	  now be provided to the function.  Also, added new function:
	  silc_command_encode_reply_payload_va which is same as
	  normal command_encode_payload_va except command status type
	  is provided as extra argument.

Tue Jul  4 18:26:39 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added ~./silc directory handling.  The directory includes the
	  public and private keys for the client.

	  Added silc_client_check_silc_dir, silc_client_create_identifier
	  and silc_client_load_keys.

	* Implemented SILC protocol compliant public key.  Added public
	  and private key saving to and loading from files.

	  Added into silcpkcs.[ch]: silc_pkcs_encode_identifier,
	  silc_pkcs_public_key_encode[_data], silc_pkcs_public_key_decode,
	  silc_pkcs_private_key_encode[_data], silc_pkcs_private_key_decode,
	  silc_pkcs_public_key_alloc, silc_pkcs_public_key_free,
	  silc_pkcs_private_key_alloc and silc_pkcs_private_key_free.

	  Implemented: silc_pkcs_save_[public/private]_key[_data] and
	  silc_pkcs_load_[public/private]_key.

Mon Jul  3 18:51:27 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added silc_server_get_route (route.[ch]) to get connection
	  data for the fastest route for given ID.

	* Implemented INVITE command on client and server.  The command
	  were re-defined in the SILC Protocol Specification and the
	  implementation now complies with the specification.

	* Implemented PING command on client and server.

	* Implemented NAMES command on client and server.  The server side
	  supports currently only normal server not router server yet.
	  Some changes to NAMES definition in SILC protocol specification.

Sun Jul  2 18:23:01 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Implemented LEAVE command on client and server.

	* Previously deprecated SILC_PACKET_FORWARDED flag is now in use 
	  again.  This change was made to the protocol as well.  Server
	  should not violate the protocol specification anymore.

Fri Jun 30 14:03:26 EEST 2000  Pekka Riikonen <priikone@poseidon.pspt.fi>

	* Added SOCKS4 and SOCKS5 support to SILC client.  SOCKS5
	  was tested.  SOCKS4 was not but should work anyway.
